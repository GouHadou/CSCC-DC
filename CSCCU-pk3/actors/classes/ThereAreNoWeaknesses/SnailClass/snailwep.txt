actor TankSnailWeapon : BaseMM8BDMWep
{
Weapon.AmmoUse1 0
Weapon.AmmoGive1 0
Weapon.SlotNumber 2
Obituary "$OB_TANKSNAIL"
Inventory.Pickupmessage "$PU_TANKSNAIL"
tag "$TAG_TANKSNAIL"
weapon.ammotype1 "TankSnailHeat"
inventory.pickupsound "weapon/weaponup"
inventory.icon "SNELICO2"
dropitem "BallisticMucusWepGiver"
+WEAPON.AMMO_OPTIONAL
Scale 2.0
States
{
Spawn:
TNT1 A 0
TNT1 A 1
stop
Ready:
BLMU A 0 ACS_ExecuteAlways(998,0,710)
BLMU A 0 A_GunFlash
BLMU A 1 A_WeaponReady(WRF_ALLOWZOOM|WRF_ALLOWRELOAD)
BLMU A 0 A_Jumpif(CallACS("InputGrab",6) == True,"Reload")
BLMU A 0 A_Jumpif(CallACS("InputGrab",7) == True,"Zoom")
Goto Ready+2
Deselect:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Lower
BLMU A 1 A_Lower
Loop
Select:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
BLMU A 1 A_Raise
Loop
Fire:
BLMU A 0 A_JumpIfInventory("HotSnail",1,"NoAmmo")
BLMU AAB 2
BLMU B 0 SetPlayerProperty(0,1,0)
BLMU B 0 A_PlaySoundEx("weapon/concreteshot","Weapon")
BLMU B 2 A_FireCustomMissile("MucusBomb",0,0,0,12)
BLMU B 0 A_FireCustomMissile("MucusDrop3",-15,0,0,12)
BLMU B 0 A_FireCustomMissile("MucusDrop3",15,0,0,12)
BLMU B 0 A_GiveInventory("TankSnailHeat",10)
BLMU A 0 A_JumpIfInventory("TankSnailHeat",0,1)
goto FireEnd
BLMU A 0 A_Stop
BLMU A 0 A_SpawnItemEx("HotSnailTracker")
BLMU A 0 A_GiveInventory("HotSnail", 1)
FireEnd:
BLMU BBC 2
BLMU C 0 SetPlayerProperty(0,0,0)
BLMU CCCBBAA 3
Goto Ready+2
AltFire:
BLMU A 0 A_JumpIfInventory("HotSnail",1,"NoAmmo")
BLMU A 0 A_GiveInventory("SnailBoostFlag", 1)
BLMU A 0 A_Refire
BLMU A 5
BLMU A 0 A_TakeInventory("SnailBoostFlag", 0)
Goto Ready+2
AltHold:
BLMU A 0 A_JumpIfInventory("HotSnail",1,"NoAmmo")
BLMU A 0 ThrustThingZ(0, 6, 0, 0)
BLMU A 0 A_PlaySoundEX("weapon/superboost", "Weapon")
BLMU A 2
BLMU A 0 ThrustThingZ(0, 6, 0, 0)
BLMU A 0 A_PlaySoundEX("weapon/superboost", "Weapon")
BLMU A 2
BLMU A 0 A_GiveInventory("TankSnailHeat", 1)
BLMU A 0 A_JumpIfInventory("TankSnailHeat",0,"HotDrop")
BLMU A 0 A_Refire
BLMU A 0
goto AltEnd
HotDrop:
BLMU A 0 A_Stop
BLMU A 0 A_SpawnItemEx("HotSnailTracker")
BLMU A 0 A_GiveInventory("HotSnail", 1)
goto AltEnd
AltEnd:
BLMU A 0 A_TakeInventory("SnailBoostFlag", 0)
BLMU A 5
BLMU A 0 //A_SpawnItemEx("SnailCrush") //Crud, dunno how to make this work...
BLMU A 0 A_JumpIfInventory("TankSnailHeat",0,"Overheat")
Goto Ready+2
Zoom:
BLMU A 0 A_JumpIfInventory("HotSnail",1,"NoAmmo")
BLMU A 0 A_SpawnItemEx("HotTankTrail")
BLMU A 0 A_PlaySoundEX("weapon/superboost", "Weapon")
BLMU A 0 A_Recoil(-4)
BLMU A 0 A_GiveInventory("TankSnailHeat", 4)
BLMU A 3
BLMU A 0 A_JumpIfInventory("TankSnailHeat",0,"Overheat")
Goto Ready+2
Reload:
BLMU A 0 A_JumpIfInventory("GlaucusCount",1,"NoAmmo")
BLMU A 0 A_PlaySoundEx("misc/itemthrow","Weapon")
BLMU A 0 A_SpawnItemEx("GlaucusLeft",0,30,28)
BLMU A 0 A_SpawnItemEx("GlaucusRight",0,-30,28)
BLMU A 25
Goto Ready+2
Overheat: //If Snail's heat meter is too high, his moves fail.
BLMU A 0 A_Stop
BLMU A 0 A_SpawnItemEx("HotSnailTracker")
BLMU A 0 A_GiveInventory("HotSnail", 1)
BLMU A 1
Goto Ready+2
NoAmmo:
BLMU A 1
BLMU A 1 ACS_Execute(979,0)
Goto Ready+2
Flash:
TNT1 A 0
TNT1 A 6
TNT1 A 0 A_JumpIfInventory("HotSnail",1,2)
TNT1 A 0 A_Jump(256,2)
TNT1 A 0 A_TakeInventory("TankSnailHeat",1)
TNT1 A 6
TNT1 A 0 A_TakeInventory("TankSnailHeat",1)
loop
}
}

actor TankSnailHeat : Ammo //Heat value, a major factor in gameplay.
{
+INVENTORY.IGNORESKILL //Would it be dumb if he overheats faster based on difficulty?
inventory.amount 1
inventory.maxamount 56
}

actor SnailBoostFlag : Inventory
{
inventory.amount 1
inventory.maxamount 1
}
actor SnailDash : Inventory
{
inventory.amount 1
inventory.maxamount 5
}
actor GlaucusCount : Inventory
{
inventory.amount 1
inventory.maxamount 2
}

actor HotSnail : Inventory //Mmm... Escargot
{
inventory.amount 1
inventory.maxamount 1
}

actor MucusBomb
{
PROJECTILE
+MTHRUSPECIES
Radius 6
Height 7
scale 2.5
Translation "198:198=110:110"
damage (0)
damagetype "SlugBlind" //Note: Remove old Tank Snail damage types.
obituary "$OB_SNAILBOMB"
+EXPLODEONWATER
-NOGRAVITY
speed 45
States
{
Spawn:
BLMU DEDF 3
BLMU F 0 A_SpawnItemEX("MucusDrop",0,0,0,0,0,0,0,SXF_TRANSFERTRANSLATION)
loop
Death:
BLMU D 0 A_PlaySoundEx("misc/oil", "Weapon")
BLMU D 0 A_Explode(40,100,0)
BLMU D 0 A_Stop
BLMU D 0 A_SpawnItemEX("MucusDrop",0,0,0,10,0,12,135,SXF_TRANSFERTRANSLATION)
BLMU D 0 A_SpawnItemEX("MucusDrop",0,0,0,10,0,12,-135,SXF_TRANSFERTRANSLATION)
BLMU D 0 A_SpawnItemEX("MucusDrop",0,0,0,10,0,12,45,SXF_TRANSFERTRANSLATION)
BLMU D 0 A_SpawnItemEX("MucusDrop",0,0,0,10,0,12,-45,SXF_TRANSFERTRANSLATION)
SNLZ MNOPQ 2
stop
}
}

actor MucusDrop
{
PROJECTILE
+MTHRUSPECIES
Damage (4)
damagetype "SlugFeet"
obituary "$OB_SNAILBOMB"
Height 5
Radius 5
-NOGRAVITY
Scale 2.0
Translation "198:198=110:110"
speed 0
States
{
Spawn:
BLMU G 0
BLMU G 5 A_CheckFloor("Death")
loop
Death:
BLMU G 1 
BLMU G 0 A_JumpIf(z-floorz<=0,"Death2")
loop
Death2:
BLMU G 0 A_PlaySoundEx("weapon/oilshot","Weapon")
BLMU G 1 A_SpawnItemEx("MucusBlob",0,0,0,0,0,0,0,SXF_TRANSFERTRANSLATION)
stop
}
}

actor MucusDrop2 : MucusDrop
{
obituary "$OB_SNAILTRAIL"
}

actor MucusDrop3 : MucusDrop
{
speed 5
}

Actor MucusBlob
{
+MISSILE
+NODAMAGETHRUST
+NOBLOOD
+DONTSPLASH
+NOEXPLODEFLOOR
+NOTARGETSWITCH
+MTHRUSPECIES
Damage (1)
damagetype "SlugFeet2"
obituary "$OB_SNAILTRAIL"
Height 10
Radius 8
scale 2.5
Translation "198:198=110:110"
reactiontime 250
painchance 256
states
{
Spawn:
BLMU H 1
Goto Spawn2
Spawn2:
BLMU H 1
BLMU H 0 A_GiveInventory("CutterFlag", 1)
BLMU H 0 A_JumpIf(z-floorz>0,"NewShot")
BLMU H 0 A_JumpIfInventory("CutterFlag", 175, "Death")
loop
NewShot:
BLMU H 0 A_SpawnItemEx("MucusDrop", 0, 0, 0, momx, momy, momz, 0, SXF_ABSOLUTEMOMENTUM|SXF_TRANSFERTRANSLATION)
Goto Death 
Death:
TNT1 A 0
stop
}
}

actor MucusBlind : PowerStrength //Blinded by direct hit
{
damagefactor "Normal", 1.0
Powerup.Duration 105
Powerup.Color Green, 0.8
}

actor SnailCrush
{
PROJECTILE
+DONTBLAST
+NOGRAVITY
+MTHRUSPECIES
damage (0)
Radius 14
Height 2
damagetype "SlugFeet"
Obituary "$OB_TANKSNAIL"
scale 4.0
Translation "198:198=110:110"
var int user_heightone;
States
{
Spawn:
TNT1 A 0
TNT1 A 0 A_SetUserVar("user_heightone", z)
TNT1 A 3
TNT1 A 0 A_Warp(AAPTR_TARGET,0,0,0,0)
TNT1 A 0 ACS_NamedExecuteAlways("cscc_stillalive",0,0)
TNT1 A 0 A_JumpIfInTargetInventory("SnailBoostFlag",1,"Begone")
goto Spawn+2
Death:
TNT1 A 0 A_JumpIf((user_heightone - z >= 256),"Crusher")
stop
Begone:
TNT1 A 0
stop
Crusher:
TNT1 A 0 ACS_NamedExecuteAlways("cscc_stillalive",0,0)
TNT1 A 0 A_PlaySoundEx("misc/quake", "Weapon")
TNT1 A 0 A_Stop
TNT1 A 0 A_Explode(60,116,0,0,16)
TNT1 A 0 A_SpawnItemEX("MucusDrop2",24,0,0,10,0,12,0)
TNT1 A 0 A_SpawnItemEX("MucusDrop2",17,-17,0,10,0,12,45)
TNT1 A 0 A_SpawnItemEX("MucusDrop2",0,-24,0,10,0,12,90)
TNT1 A 0 A_SpawnItemEX("MucusDrop2",-17,-17,0,10,0,12,135)
TNT1 A 0 A_SpawnItemEX("MucusDrop2",-24,0,0,10,0,12,180)
TNT1 A 0 A_SpawnItemEX("MucusDrop2",-17,17,0,10,0,12,-135)
TNT1 A 0 A_SpawnItemEX("MucusDrop2",0,24,0,10,0,12,-90)
TNT1 A 0 A_SpawnItemEX("MucusDrop2",17,17,0,10,0,12,-45)
SNLZ MNOPQ 2
stop
}
}

actor FlyingSlug
{
-SOLID
//MONSTER
//PROJECTILE
+NOINTERACTION
+Missile
+DONTBLAST
+SKYEXPLODE
-SOLID
-COUNTKILL
+SHOOTABLE
+NOGRAVITY
+HITTRACER
+MTHRUSPECIES
+THRUSPECIES
+NOEXPLODEFLOOR
+SLIDESONWALLS
speed 0
scale 2.0
+SEEKERMISSILE
ReactionTime 175
+LOOKALLAROUND
Radius 20
Height 20
reactiontime 224
meleerange 20
damage(0)
health 1
painchance 256
DamageType "GlaucusNeedle"
Obituary "$OB_SNAILFLY"
Translation "198:198=80:80","192:192=76:76"
States
{
Spawn:
SNLZ S 0
SNLZ S 0 A_GiveToTarget("GlaucusCount",1)
TNT1 A 0 ACS_NamedExecuteAlways("PlayerSpeciesSynch",0)
TNT1 A 2
TNT1 A 0 A_ChangeFlag("NOINTERACTION",0)
TNT1 A 0 A_Jump(256,"Spawn2")
Spawn2:
SNLZ S 0 A_Warp(AAPTR_TARGET,0,0,28,0)
SNLZ S 0 A_SeekerMissile(4, 0, SMF_LOOK|SMF_PRECISE, 256, 1000)
SNLZ SSSSS 1 A_JumpIfTargetInLOS("Missile", 0, JLOSF_PROJECTILE)
SNLZ R 0 A_Warp(AAPTR_TARGET,0,0,28,0)
SNLZ R 0 A_SeekerMissile(4, 0, SMF_LOOK|SMF_PRECISE, 256, 1000)
SNLZ RRRRR 1 A_JumpIfTargetInLOS("Missile", 0, JLOSF_PROJECTILE)
TNT1 A 0 ACS_NamedExecuteAlways("cscc_stillalive",0,0)
TNT1 A 0 A_Jump(256,"Spawn2")
goto Spawn2
Missile:
TNT1 A 0 ACS_NamedExecuteAlways("cscc_stillalive",0,0)
SNLZ S 0 A_SeekerMissile(4, 10, SMF_PRECISE)
SNLZ S 0 A_PlaySoundEx("misc/devilfire","Voice")
SNLZ S 0 A_FaceTracer(0, 0)
TRET A 0 ACS_NamedExecuteAlways("PitchToTracer",0,0)
SNLZ S 5 A_SpawnItemEx("GlaucusNeedle",cos(-pitch)*35,0,20+(sin(pitch)*35),cos(-pitch)*35,0,sin(pitch)*35,0,SXF_TRANSFERPOINTERS|SXF_TRANSFERPITCH)
//A_CustomMissile("GlaucusNeedle",10,0,0,CMF_AIMDIRECTION)
SNLZ RSRSRSR 5
goto FollowBack
FollowBack:
SNLZ S 0 A_Stop
//SNLZ S 0 A_FaceTarget
SNLZ S 0 A_RearrangePointers(AAPTR_DEFAULT,AAPTR_DEFAULT,AAPTR_TARGET)
SNLZ S 0 A_FaceTracer(0, 0)
TRET A 0 ACS_NamedExecuteAlways("PitchToTracer",0,0)
SNLZ S 0 A_GiveInventory("GlaucusMoveBack")
SNLZ SSSSSRRRRR 1 A_JumpIfCloser(30,"HeBack")
TNT1 A 0 ACS_NamedExecuteAlways("cscc_stillalive",0,0)
loop
HeBack:
SNLZ S 0 A_ChangeVelocity(0,0,0,CVF_RELATIVE|CVF_REPLACE)
SNLZ S 0 A_RearrangePointers(AAPTR_DEFAULT,AAPTR_NULL,AAPTR_MASTER)
SNLZ S 0 A_Stop
TNT1 A 0 A_Jump(256,"Spawn2")
goto Spawn2
Begone:
Pain:
Death:
TNT1 A 0 A_TakeFromTarget("GlaucusCount",1)
SNLZ T 0 A_PlaySoundEx("misc/slugoof","Voice")
SNLZ T 0 A_SpawnItemEx("SlugShootdown",0,0,0,-8,0,5,random(-5,5),SXF_TRANSFERTRANSLATION)
stop
}
}
actor GlaucusNeedle
{
PROJECTILE
+MTHRUSPECIES
Radius 5
Height 5
damagetype "GlaucusNeedle"
Obituary "$OB_SNAILFLY"
scale 1.5
damage (7)
speed 35
States
{
Spawn:
NEDC A 1
loop
}
}
actor SlugShootdown
{
scale 2.0
+MISSILE
-SOLID
-NOGRAVITY
Translation "198:198=80:80","192:192=76:76"
Height 1
Radius 1
States
{
Spawn:
SNLZ T 5
loop
}
}
actor GlaucusLeft : FlyingSlug
{
States
{
Spawn2:
SNLZ SSSSS 1 A_Warp(AAPTR_TARGET,0,30,28,0)
SNLZ S 0 A_SeekerMissile(4, 0, SMF_LOOK|SMF_PRECISE, 256, 1000)
SNLZ S 0 A_JumpIfTargetInLOS("Missile", 0, JLOSF_PROJECTILE)
SNLZ RRRRR 1 A_Warp(AAPTR_TARGET,0,30,28,0)
SNLZ R 0 A_SeekerMissile(4, 0, SMF_LOOK|SMF_PRECISE, 256, 1000)
SNLZ R 0 A_JumpIfTargetInLOS("Missile", 0, JLOSF_PROJECTILE)
TNT1 A 0 ACS_NamedExecuteAlways("cscc_stillalive",0,0)
TNT1 A 0 A_Jump(256,"Spawn2")
goto Spawn2
HeBack:
SNLZ S 0 A_ChangeVelocity(0,0,0,CVF_RELATIVE|CVF_REPLACE)
SNLZ S 0 A_RearrangePointers(AAPTR_DEFAULT,AAPTR_DEFAULT,AAPTR_NULL)
SNLZ S 0 A_Stop
TNT1 A 0 A_Jump(256,"Spawn2")
goto Spawn2
}
}
actor GlaucusRight : FlyingSlug
{
States
{
Spawn2:
SNLZ SSSSS 1 A_Warp(AAPTR_TARGET,0,-30,28,0)
SNLZ S 0 A_SeekerMissile(4, 0, SMF_LOOK|SMF_PRECISE, 256, 1000)
SNLZ S 0 A_JumpIfTargetInLOS("Missile", 0, JLOSF_PROJECTILE)
SNLZ RRRRR 1 A_Warp(AAPTR_TARGET,0,-30,28,0)
SNLZ R 0 A_SeekerMissile(4, 0, SMF_LOOK|SMF_PRECISE, 256, 1000)
SNLZ R 0 A_JumpIfTargetInLOS("Missile", 0, JLOSF_PROJECTILE)
TNT1 A 0 ACS_NamedExecuteAlways("cscc_stillalive",0,0)
TNT1 A 0 A_Jump(256,"Spawn2")
goto Spawn2
HeBack:
SNLZ S 0 A_ChangeVelocity(0,0,0,CVF_RELATIVE|CVF_REPLACE)
SNLZ S 0 A_RearrangePointers(AAPTR_DEFAULT,AAPTR_DEFAULT,AAPTR_NULL)
SNLZ S 0 A_Stop
TNT1 A 0 A_Jump(256,"Spawn2")
goto Spawn2
}
}

actor HotSnailTracker
{
+MISSILE
+NOINTERACTION
+DONTBLAST
states
{
Spawn:
TNT1 A 0
TNT1 A 0 A_Warp(AAPTR_TARGET,0,0,0,0)
TNT1 A 0 A_PlaySoundEx("misc/sharklaser","voice")
TNT1 AAA 0 A_SpawnItemEx("ShockFX", random(-12,12), random(-12,12),random(0,32)) 
Spawn2:
TNT1 A 0 A_SpawnItemEx("HotSnailFX",random(-20, 20),random(-20, 20),random(16,48),0,0,5,random(0,360))
TNT1 A 0 A_JumpIfInTargetInventory("TankSnailHeat",1,1)
goto Cold
TNT1 A 5 A_Warp(AAPTR_TARGET,0,0,0,0)
TNT1 A 0 A_SpawnItemEx("HotSnailFX",random(-20, 20),random(-20, 20),random(16,48),0,0,5,random(0,360))
TNT1 A 0 A_JumpIfInTargetInventory("TankSnailHeat",1,1)
goto Cold
TNT1 A 0
loop
Cold:
TNT1 A 0 A_TakeFromTarget("HotSnail",0)
stop
}
}
actor HotSnailFX
{
+NOINTERACTION
+NOGRAVITY
+CLIENTSIDEONLY
+MISSILE
scale 1.5
renderstyle translucent
alpha 0.8
States
{
Spawn:
POOF A 0
POOF A 1 A_FadeOut(0.1)
POOF A 1 //A_SetScale(scaleX + 0.1, scaleY + 0.1)
loop
}
}

//Copywep
actor BallisticMucusWep : BaseMM8BDMWep
{
Weapon.AmmoUse 7
Weapon.AmmoGive 28
Weapon.SlotNumber 2
Obituary "$OB_SNAILBOMB"
Inventory.Pickupmessage "$PU_TANKSNAIL"
weapon.ammotype "BallisticMucusAmmo"
inventory.pickupsound "weapon/weaponup"
+WEAPON.AMMO_OPTIONAL
inventory.icon "BLMUICO"
dropitem "BallisticMucusWepGiver"
Scale 2.0
States
{
Spawn:
BLMU X 1
loop
Ready:
BLMU I 0 ACS_ExecuteAlways(998,0,710)
BLMU I 1 A_WeaponReady
Goto Ready+1
Deselect:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Lower
BLMU I 1 A_Lower
Loop
Select:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
BLMU I 1 A_Raise
Loop
Fire:
BLMU I 0 A_JumpIfNoAmmo("NoAmmo")
BLMU IIJ 2
BLMU J 0 SetPlayerProperty(0,1,0)
BLMU J 0 A_PlaySoundEx("weapon/concreteshot","Weapon")
BLMU J 2 A_FireCustomMissile("MucusBomb",0,1,8,0)
BLMU I 0 A_ChangeVelocity(-18, 0, 0, CVF_RELATIVE)
BLMU JJK 2
BLMU K 0 SetPlayerProperty(0,0,0)
BLMU KKKJJII 2
BLMU I 0 A_Refire
Goto Ready+1
NoAmmo:
BLMU I 1
BLMU I 1 ACS_Execute(979,0)
Goto Ready+1
}
}
actor BallisticMucusAmmo : Ammo
{
+INVENTORY.IGNORESKILL
inventory.amount 1
inventory.maxamount 28
}

actor GlaucusMoveBack : CustomInventory //Spawn item, creates checker
{
+INVENTORY.AUTOACTIVATE
-COUNTITEM
states
{
Pickup:
TNT1 A 1 A_Jumpif(z-floorz > 30, "Pickup.Move1")
SNLZ S 0 A_ChangeVelocity(20,0,0,CVF_RELATIVE|CVF_REPLACE)
stop
Pickup.Move1:
SNLZ S 0 A_ChangeVelocity(20,0,sin(pitch)*20,CVF_RELATIVE|CVF_REPLACE)
stop
}
}

actor TankSnailTrail
{
PROJECTILE
Damage (2)
obituary "$OB_SNAILTRAIL"
damagetype "SlugFeet3" //Give victim the SlugFeet3 item.
Height 3
Radius 24
-NOGRAVITY
+FLOORHUGGER
+NOEXPLODEFLOOR
+DONTBLAST
XScale 3.0
YScale 2.5
Translation "192:192=110:110"
speed 0
States
{
Spawn:
SNTR B 20
stop
}
}

actor HotTankTrail : TankSnailTrail
{
Damage (5)
obituary "$OB_SNAILDASH"
damagetype "SlugFeet"
Translation "192:192=42:42"
+NOGRAVITY
-FLOORHUGGER
+RIPPER
States
{
Spawn:
SNTR B 0
SNTR B 0 A_GiveToTarget("SnailDash",1)//prevent trailing
SNTR BB 5
SNTR B 0 A_TakeFromTarget("SnailDash",1)
stop
}
}