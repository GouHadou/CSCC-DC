actor EnergyBladeWeapon : Megabuster
{
Weapon.AmmoUse 1
Weapon.AmmoUse2 7
Weapon.AmmoGive 28
Weapon.SlotNumber 1
Inventory.Pickupmessage "TABNAM DNA WOY REDNOB"
weapon.ammotype "Energy"
weapon.ammotype2 "Energy"
inventory.pickupsound "weapon/weaponup"
inventory.icon "ENBLROW"
+WEAPON.ALT_AMMO_OPTIONAL
Scale 2.0
States
{
Spawn:
WEA3 K 1
loop
Ready:
CRHU A 0 ACS_ExecuteAlways(998,0,59)
CRHU A 1 //ACS_ExecuteAlways(991,0,59) 
CRHU A 1 A_WeaponReady
Goto Ready+2
Deselect:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Lower
CRHU A 1
Loop
Select:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
CRHU A 1 
Loop
Fire:
CRHU A 0 A_JumpIfNoAmmo("NoAmmo")
CRHU A 1
goto Hold
Hold:
CRHU B 0 A_JumpIfNoAmmo("NoAmmo")
CRHU B 0 A_JumpIfInventory("WeaponCharge",4,"Hold2")
CRHU B 0 A_JumpIfInventory("WeaponCharge",3,"HoldStart")
CRHU B 2 A_GiveInventory("WeaponCharge",1)
CRHU B 0 A_Refire
Goto Fire1
HoldStart:
CRHU B 0 A_PlaySoundEx("weapon/coilstart", "Weapon")
Goto Hold2
Hold2:
//CRHU A 0 A_StopSoundEx ("Weapon") 
CRHU B 0 A_JumpIfInventory("WeaponCharge",23,"Hold3")
CRHU B 0 A_JumpIfInventory("WeaponCharge",22,"HoldStart2")
CRHU I 1 ACS_ExecuteAlways(991,0,96)
CRHU B 1 ACS_ExecuteAlways(991,0,59)
CRHU B 0 A_GiveInventory("WeaponCharge",1)
CRHU I 0 A_Refire
Goto Fire1
HoldStart2:
SAPT B 0 ACS_ExecuteAlways(974,0)
CRHU B 0 A_GunFlash
CRHU B 0 A_GiveInventory("WeaponCharge",1)
Goto Hold3
Hold3: 
//CRHU H 0 A_PlaySoundEx("weapon/coilcharge", "Weapon")
CRHU H 1 ACS_ExecuteAlways(991,0,96)
CRHU H 1 ACS_ExecuteAlways(991,0,22)
CRHU I 1 ACS_ExecuteAlways(991,0,96)
CRHU I 0 A_JumpIfInventory("IsBot", 1, "BotFire")
CRHU H 0 A_Refire
Goto Fire2
BotFire:
CRHU A 0 A_Jump(16, "Fire2")
CRHU B 0 A_Refire
Goto Fire2
Flash:
TNT1 B 5 A_PlaySoundEx("weapon/coilcharge", "Weapon")
TNT1 B 0 A_JumpIfInventory("WeaponCharge",1,"Flash")
stop
Fire1:
HEAT G 0 ACS_ExecuteAlways(991,0,59) 
CRHU A 0 A_StopSoundEx ("Weapon") 
CRHU A 0 A_TakeInventory("WeaponCharge",700)
CRHU A 0 A_ClearRefire
CRHU A 0 //A_PlaySoundEx("weapon/atomicfire","Weapon")
CRHU A 0 A_TakeInventory("Energy",1)
TNT1 A 1 A_PlaySoundEx("weapon/slashclaw","Weapon")
CRHU A 0 A_FireCustomMissile("EnergyBlade",0,0,0,0)
CRHU BCDEF 2
//TNT1 A 8
CRHU RS 1
Goto Ready+1
Fire2:
HEAT G 0 ACS_ExecuteAlways(991,0,59) 
HEAT G 0 A_StopSoundEx ("Weapon") 
HEAT G 0 A_TakeInventory("WeaponCharge",700)
HEAT G 0 A_ClearRefire
HEAT G 0 //A_PlaySoundEx("weapon/wild","Weapon")
HEAT G 0 A_JumpIfInventory("Energy", 14, "Fire2r")
CRHU A 0 A_TakeInventory("Energy",1)
TNT1 A 1 A_PlaySoundEx("weapon/slashclaw","Weapon")
CRHU A 0 A_FireCustomMissile("EnergyBlade",0,0,0,6)
CRHU BCDEF 2
TNT1 A 8
CRHU RS 1
Goto Ready+1
Fire2r:
HEAT G 0 ACS_ExecuteAlways(991,0,59) 
CRHU A 0 A_Stop
CRHU A 0 SetPlayerProperty(0,1,4)
CRHU B 0 A_ChangeFlag("NOGRAVITY", 1)
CRHU CDEF 2
CRHU A 0 A_TakeInventory("Energy",14)
CRHU C 2 A_ChangeVelocity(-5,0,momz,CVF_RELATIVE|CVF_REPLACE)
TNT1 A 1 A_PlaySoundEx("weapon/slashclaw","Weapon")
TNT1 A 1
TNT1 A 1 A_PlaySoundEx("weapon/slashclaw","Weapon")
TNT1 A 1
TNT1 A 1 A_PlaySoundEx("weapon/slashclaw","Weapon")
CRHU B 0 A_FireCustomMissile("EnergyBladeRowStart",0,0,0,0)
TNT1 A 1 A_PlaySoundEx("weapon/slashclaw","Weapon")
TNT1 A 1
TNT1 A 1 A_PlaySoundEx("weapon/slashclaw","Weapon")
TNT1 A 1
TNT1 A 1 A_PlaySoundEx("weapon/slashclaw","Weapon")
TNT1 A 1
TNT1 A 1 A_PlaySoundEx("weapon/slashclaw","Weapon")
TNT1 A 1
TNT1 A 1 A_PlaySoundEx("weapon/slashclaw","Weapon")
TNT1 A 1
TNT1 A 1 A_PlaySoundEx("weapon/slashclaw","Weapon")
TNT1 A 1
CRHU C 0 ACS_ExecuteAlways(991,0,59)
CRHU A 0 A_TakeInventory("Energy",2)
TNT1 A 12
CRHU A 0 A_TakeInventory("Energy",2)
TNT1 B 18
CRHU A 0 SetPlayerProperty(0,0,4)
CRHU C 0 A_ChangeFlag("NOGRAVITY", 0)
TNT1 B 9
CRHU RS 1
Goto Ready+1
NoAmmo:
CRHU A 1 ACS_Execute(979,0)
CRHU A 0 A_Refire
Goto Ready+1
    Altfire:
CRHU A 0 A_JumpIfNoAmmo("NoAmmo")
CRHU A 0 A_JumpIf(z-floorz==0,"Leap")
CRHU A 1 
Goto Ready+1
Leap:
CRHU B 0 A_Stop
CRHU B 0 ThrustThingZ(0,8,3,0)
CRHU B 4 
CRHU B 0 A_PlaySoundEx("weapon/coilbounce1", "Voice")
CRHU B 0 ThrustThingZ(0,25,0,0)
CRHU B 0 A_Recoil(-25)
TNT1 B 4
CRHU B 0 A_JumpIf(floorz-z==0,"Leap")
CRHU C 0 A_FireCustomMissile("SwiftBash",0,0,0,6)
TNT1 C 1 A_PlaySoundEx("weapon/chargekick","Weapon")
TNT1 C 1
CRHU C 0 A_FireCustomMissile("SwiftBash",0,0,0,6)
TNT1 C 1
CRHU B 0 A_FireCustomMissile("SwiftBash",0,0,0,6)
CRHU B 0 A_TakeInventory("Energy",7)
TNT1 B 12
CRHU B 0 A_TakeInventory("Energy",2)
CRHU B 37
Goto Ready+1
}
}

actor EnergyBladeProtect : PowerProtection
{
Powerup.Duration 10
damagefactor "EnergyBlade", 0.5
}

//Mainfire

actor EnergyBlade // WATCH AS THIS CONFLICTS WITH EVERYTHING
{
PROJECTILE
+LOOKALLAROUND
+SKYEXPLODE
+FORCEXYBILLBOARD
+DONTBLAST
Radius 18
Height 24
scale 2.5
damage (18)
damagetype "EnergyBlade"
Obituary "%o was pierced by %k's Energy Blade."
speed 65
States
{
Spawn:
ENBL D 1
loop
Death:
ENBL D 0
stop
}
}

//Mainfire Charge

actor EnergyBladeRowStart //Bucketload of thanks to Tsuki
{
PROJECTILE
+LOOKALLAROUND
+SKYEXPLODE
+DONTBLAST
+NOINTERACTION
+PAINLESS
Radius 0
Height 0
damage (0)
speed 1
States
{
Spawn:
TNT1 A 1
TNT1 A 0 A_SpawnItemEx("EnergyBlade",0,0,0,momx*45,momy*45,momz*45,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
TNT1 A 2
TNT1 A 0 A_SpawnItemEx("EnergyBlade",0,10,0,momx*45,momy*45,momz*45,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
TNT1 A 2
TNT1 A 0 A_SpawnItemEx("EnergyBlade",0,-5,0,momx*45,momy*45,momz*45,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
TNT1 A 2
TNT1 A 0 A_SpawnItemEx("EnergyBlade",0,0,0,momx*45,momy*45,momz*45,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
TNT1 A 2
TNT1 A 0 A_SpawnItemEx("EnergyBlade",0,4,0,momx*45,momy*45,momz*45,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
TNT1 A 2
TNT1 A 0 A_SpawnItemEx("EnergyBlade",0,-8,0,momx*45,momy*45,momz*45,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
TNT1 A 2
TNT1 A 0 A_SpawnItemEx("EnergyBlade",0,0,0,momx*45,momy*45,momz*45,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
TNT1 A 2
TNT1 A 0 A_SpawnItemEx("EnergyBlade",0,12,0,momx*45,momy*45,momz*45,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
TNT1 A 2
TNT1 A 0 A_SpawnItemEx("EnergyBlade",0,-6,0,momx*45,momy*45,momz*45,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
TNT1 A 2
TNT1 A 0 A_SpawnItemEx("EnergyBlade",0,0,0,momx*45,momy*45,momz*45,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
TNT1 A 2
TNT1 A 0 A_SpawnItemEx("EnergyBlade",0,14,0,momx*45,momy*45,momz*45,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
TNT1 A 2
TNT1 A 0 A_SpawnItemEx("EnergyBlade",0,-7,0,momx*45,momy*45,momz*45,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
TNT1 A 2
TNT1 A 0 A_SpawnItemEx("EnergyBlade",0,1,0,momx*45,momy*45,momz*45,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
TNT1 A 2
TNT1 A 0 A_SpawnItemEx("EnergyBlade",0,-1,0,momx*45,momy*45,momz*45,0,SXF_NOCHECKPOSITION|SXF_ABSOLUTEMOMENTUM)
TNT1 A 2
stop
Death:
TNT1 A 0
stop
}
}

//Altfire

actor SwiftBash
{
PROJECTILE
+RIPPER
Radius 5
Height 5
scale 2.5
damage (0)
damagetype "Buster"
Obituary "%o's body was not ready for %k's Swift Bash."
speed 36
States
{
Spawn:
SBSH HIJKL 1 A_Explode(9,95,0)
stop
}
}


//Ammo

actor Energy : Ammo
{
inventory.amount 1
inventory.maxamount 28
}