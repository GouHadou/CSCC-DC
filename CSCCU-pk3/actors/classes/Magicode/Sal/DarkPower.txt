actor DarkPower : MegaBuster
{
Weapon.AmmoUse 1
Weapon.AmmoGive 0
Weapon.SlotNumber 2
inventory.pickupmessage "\cmMay your heart be tainted..."
inventory.pickupsound "weapon/weaponup"
Obituary "%o's heart and body were consumed by the darkness of %k."
weapon.ammotype "DarkEnergy"
+WEAPON.AMMO_OPTIONAL
+INVENTORY.UNDROPPABLE
+WEAPON.CHEATNOTWEAPON
Tag "Dark Form (Shadow Ball/Dark Pulse/Feint Attack)"
inventory.icon "FATKA0"
Scale 2.0
States
{
Spawn:
WEAP X 1
loop
Ready:
SHUD A 0 ACS_ExecuteAlways(998,0,504)
SHUD A 0 A_GunFlash
SHUD A 10 A_WeaponReady
SHUD AAA 1 A_WeaponReady
SHUD A 0 A_JumpIfInventory("User1_Trigger",1,"AmmoCheck")
SHUD A 0 A_GiveInventory("DarkEnergy",3)
SHUD A 0 A_GiveInventory("PsychicEnergy",2)
Goto Ready+3
AmmoCheck:
SHUD A 0 A_JumpIfInventory("FeintAttackEnergy",100,"FAttack")
SHUD A 0 A_TakeInventory("User1_Trigger",999)
goto Ready+3
Deselect:
TNT1 A 0 A_TakeInventory("SBCharge",999)
TNT1 A 0 A_TakeInventory("User1_Trigger",999)
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Lower
SHUD A 1 A_Lower
goto Deselect+2
Select:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
SHUD A 1 A_Raise
Loop
Fire:
SHUD A 0 A_JumpIfInventory("SmashFlag",1,"VoidFall") //filler
SHUD A 2
goto Hold
Hold:
SHUD A 0 A_JumpIfInventory("SBCharge",1,"Hold2")
SHUD A 2 A_GiveInventory("SBCharge",1)
SHUD A 0 A_Refire
Goto Fire1
Hold2:
SHUD A 0 A_StopSoundEx ("Weapon") 
SHUD A 0 A_PlaySoundEx("weapon/heat1","Weapon")
SHUD A 0 A_JumpIfInventory("SBCharge",25,"Hold3")
SHUD D 1 ACS_ExecuteAlways(991,0,505)
SHUD A 1 ACS_ExecuteAlways(991,0,504)
SHUD A 0 A_GiveInventory("SBCharge",1)
SHUD A 0 A_GiveInventory("DarkEnergy",1)
SHUD A 0 A_Refire
Goto Fire1
Hold3:
SHUD A 0 A_StopSoundEx ("Weapon") 
SHUD A 0 A_PlaySoundEx("weapon/heat2","Weapon")
SHUD A 0 A_JumpIfInventory("SBCharge",50,"Hold4")
SHUD G 1 ACS_ExecuteAlways(991,0,506)
SHUD A 1 ACS_ExecuteAlways(991,0,504)
SHUD A 0 A_GiveInventory("SBCharge",1)
SHUD A 0 A_GiveInventory("DarkEnergy",1)
SHUD A 0 A_Refire
Goto Fire2
BotFire:
SHUD A 0 A_Jump(16,"Fire3b")
SHUD A 0 A_Refire
Goto Fire3
Hold4:
SHUD A 0 A_StopSoundEx ("Weapon")
SHUD A 0 A_PlaySoundEx("weapon/heat3", "Weapon")
SHUD J 1 ACS_ExecuteAlways(991,0,507)
SHUD A 1 ACS_ExecuteAlways(991,0,504)
SHUD A 0 A_GiveInventory("DarkEnergy",1)
SHUD A 0 A_JumpIfInventory("IsBot", 1, "BotFire")
SHUD A 0 A_Refire
Goto Fire3
Fire1:
SHUD A 0 A_StopSoundEx ("Weapon") 
SHUD A 0 A_TakeInventory("SBCharge",500)
SHUD A 0 A_ClearRefire
SHUD A 0 A_PlaySoundEx("weapon/atomicfire","Weapon")
SHUD A 0 A_FireCustomMissile("ShadowBall1",0,0,8,0)
SHUD EF 2
Goto Ready+3
Fire2:
SHUD A 0 A_StopSoundEx("Weapon") 
SHUD A 0 A_TakeInventory("SBCharge",500)
SHUD A 0 A_ClearRefire
SHUD A 0 A_PlaySoundEx("weapon/atomicfire","Weapon")
SHUD A 0 A_JumpIfInventory("ShadowBallAmmo",5,"Fire2b")
SHUD A 0 A_FireCustomMissile("ShadowBall2",0,0,8,0)
SHUD HI 3
Goto Ready+3
Fire2b:
HEAT H 0 A_FireCustomMissile("ShadowBall2",0,0,8,0)
SHUD HI 3
SHUD EF 2
Goto Ready+3
Fire3b:
HEAT H 0 A_FireCustomMissile("ShadowBall3",0,0,8,0)
SHUD HI 3
SHUD EF 2
Goto Ready+3
Fire3:
SHUD A 0 A_StopSoundEx("Weapon") 
SHUD A 0 A_TakeInventory("SBCharge",500)
SHUD A 0 A_ClearRefire
SHUD A 0 A_PlaySoundEx("weapon/atomicfire","Weapon")
SHUD A 0 A_FireCustomMissile("ShadowBall3",0,0,8,0)
SHUD K 3
SHUD L 35
SHUD K 3
Goto Ready+3
FAttack:
SHUD A 0 A_TakeInventory("FeintAttackEnergy",999)
SHUD A 0 SetPlayerProperty(0,1,0)
//SHUD A 0 A_ChangeFlag("SHOOTABLE",0)
SHUD A 0 A_PlaySoundEx("pokemon/feintattack","Weapon")
SHUD A 1 A_SetTranslucent(0.8)
SHUD A 1 A_SetTranslucent(0.6)
SHUD A 1 A_SetTranslucent(0.4)
SHUD A 1 A_SetTranslucent(0.2)
SHUD A 1 A_SetTranslucent(0.0)
SHUD BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB 0 A_SpawnItemEx("SBallDeathFX",0,0,16,random(-10,10),random(-10,10),random(-10,10))
SHUD B 0 A_SpawnItemEx("FeintAttackDamager",0,0,16)
SHUD B 2 A_ChangeVelocity(cos(pitch)*15,0,-sin(pitch)*15,CVF_RELATIVE)
SHUD B 0 A_SpawnItemEx("FeintAttackDamager",0,0,16)
SHUD B 2 A_ChangeVelocity(cos(pitch)*15,0,-sin(pitch)*15,CVF_RELATIVE)
SHUD B 0 A_SpawnItemEx("FeintAttackDamager",0,0,16)
SHUD B 2 A_ChangeVelocity(cos(pitch)*15,0,-sin(pitch)*15,CVF_RELATIVE)
SHUD B 0 A_SpawnItemEx("FeintAttackDamager",0,0,16)
SHUD B 2 A_ChangeVelocity(cos(pitch)*15,0,-sin(pitch)*15,CVF_RELATIVE)
SHUD B 0 A_SpawnItemEx("FeintAttackDamager",0,0,16)
SHUD B 2 A_ChangeVelocity(cos(pitch)*15,0,-sin(pitch)*15,CVF_RELATIVE)
SHUD B 0 A_SpawnItemEx("FeintAttackDamager",0,0,16)
SHUD B 2 A_ChangeVelocity(cos(pitch)*15,0,-sin(pitch)*15,CVF_RELATIVE)
SHUD B 0 A_SpawnItemEx("FeintAttackDamager",0,0,16)
SHUD B 2 A_ChangeVelocity(cos(pitch)*15,0,-sin(pitch)*15,CVF_RELATIVE)
SHUD B 0 A_SpawnItemEx("FeintAttackDamager",0,0,16)
SHUD B 2 A_ChangeVelocity(cos(pitch)*15,0,-sin(pitch)*15,CVF_RELATIVE)
SHUD B 0 A_SpawnItemEx("FeintAttackDamager",0,0,16)
SHUD B 2 A_ChangeVelocity(cos(pitch)*15,0,-sin(pitch)*15,CVF_RELATIVE)
SHUD B 0 A_SpawnItemEx("FeintAttackDamager",0,0,16)
SHUD B 2 A_ChangeVelocity(cos(pitch)*15,0,-sin(pitch)*15,CVF_RELATIVE)
SHUD BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB 0 A_SpawnItemEx("SBallDeathFX",0,0,16,random(-10,10),random(-10,10),random(-10,10))
SHUD B 0 A_PlaySoundEx("misc/mm3explosion","Weapon")
SHUD B 1 A_SetTranslucent(0.2)
SHUD B 1 A_SetTranslucent(0.4)
SHUD B 1 A_SetTranslucent(0.6)
SHUD B 1 A_SetTranslucent(0.8)
SHUD B 1 A_SetTranslucent(1.0)
SHUD B 0 A_Stop
SHUD B 0 A_SpawnItemEx("FeintAttackBigDamager",0,0,16)
SHUD B 0 SetPlayerProperty(0,0,0)
SHUD B 0 A_TakeInventory("User1_Trigger",999)
SHUD BBBBBBBBBB 2 A_Gravity
goto Ready+2
Flash:
TNT1 A 0 A_GiveInventory("SalHPChecker",1)
TNT1 A 0 A_JumpIfInventory("IsDead",1,"FlashStop")
TNT1 A 0 A_JumpIfInventory("RollingCutterFlag",1,"FlashWait")
TNT1 AA 0 A_SpawnItemEx("SBallDeathFX2",random(-36,36),random(-36,36),0,momx,momy,random(5,15),0,SXF_ABSOLUTEMOMENTUM)
TNT1 A 3 A_GiveInventory("FeintAttackEnergy",1)
TNT1 A 0 A_GiveInventory("SalHPChecker",1)
TNT1 A 0 A_JumpIfInventory("IsDead",1,"FlashStop")
TNT1 A 0 A_JumpIfInventory("RollingCutterFlag",1,"FlashWait")
TNT1 AA 0 A_SpawnItemEx("SBallDeathFX2",random(-36,36),random(-36,36),0,momx,momy,random(5,15),0,SXF_ABSOLUTEMOMENTUM)
TNT1 A 3 A_GiveInventory("FeintAttackEnergy",1)
loop
FlashStop:
TNT1 A 1
stop
FlashWait:
TNT1 A 3
TNT1 A 0 A_GiveInventory("FeintAttackEnergy",1)
TNT1 A 0 A_JumpIfInventory("RollingCutterFlag",1,"FlashWait")
goto Flash
Altfire:
SHUD A 0 A_JumpIfNoAmmo("NoAmmo")
SHUD A 0 A_JumpIfInventory("DarkEnergy",240,"DarkPulse")
goto Ready+3
DarkPulse:
SHUD A 0 A_TakeInventory("DarkEnergy",240)
SHUD B 3
SHUD A 0 A_PlaySoundEx("weapon/pharaoh2","Weapon")
SHUD A 0 A_FireCustomMissile("DarkPulseMain",0,0,0,0)
SHUD C 25
SHUD B 3
Goto Ready+2
NoAmmo:
SHUD A 1 ACS_Execute(979,0)
Goto Ready+3
VoidFall:
SHUD A 0 A_TakeInventory("SmashFlag",999)
SHUD A 0 SetPlayerProperty(0,1,0)
SHUD A 0 SetPlayerProperty(0,2,5)
SHUD A 0 A_GiveInventory("RollingCutterFlag",1)
SHUD A 0 A_SpawnItemEx("VoidFallStartFX2",0,0,24,0,0,0,0,SXF_NOCHECKPOSITION)
SHUD A 25 A_PlaySoundEx("misc/elementsfx","Weapon") 
SHUD JK 3
SHUD L 20 A_SpawnItemEx("StarFallSpawner",0,0,40,0,0,70)
SHUD K 3
SHUD J 25
SHUD KL 3
SHUD L 60 A_SpawnItemEx("VoidStormSpawner",128,0,48,0,0,0,0)
SHUD C 3 SetPlayerProperty(0,0,0)
SHUD B 3 SetPlayerProperty(0,0,4)
SHUD A 0 A_TakeInventory("RollingCutterFlag",999)
SHUD AAAAA 1 SetPlayerProperty(0,0,5)
goto Ready+2
}
}

Actor SBCharge : Inventory{inventory.amount 1 inventory.maxamount 999}

actor DarkEnergy : Ammo
{
inventory.amount 1
inventory.maxamount 240
}

actor ShadowBallAmmo : Ammo
{
inventory.amount 1
inventory.maxamount 28
}

actor ShadowBall1
{
PROJECTILE
Obituary "%k sent %o to the Shadow Realm with a small dose of their shadow energy."
Radius 8 //12
Height 8 //12
Damage(9)
Damagetype "GhostTypeX1"
Speed 25
scale 1.0
States
{
Spawn:
SDB2 AB 4
loop
Death:
TNT1 A 0
stop
}
}

actor ShadowBall2 : ShadowBall1
{
Radius 16 //20
Height 16 //20
Damage(15)
damagetype "GhostTypeX2"
Obituary "%k sent %o to the Shadow Realm with a moderate dose of their shadow energy."
Speed 35
Scale 2.0
States
{
Spawn:
SDB2 CD 2
loop
Death:
TNT1 AAAAA 0 A_SpawnItemEx("SBallDeathFX",0,0,4,random(-13,13),random(-13,13),random(5,15),0,0,0)
stop
}
}

actor ShadowBall3 : ShadowBall1
{
Translation "209:215=6:6", "208:208=63:63", "4:4=63:63"
Radius 28
Height 28 
Damage(20)
damagetype "GhostTypeX3"
Obituary "%k sent %o to the Shadow Realm with a \crYOU DIE \c-dose of their shadow energy."
Scale 3.5
Speed 40
States
{
Spawn:
SDB1 A 0
SDB1 AABB 1 A_SpawnItemEx("ShadowBallFX") 
loop
Death:
BOMB AAAAAAAAAA 0 A_SpawnItemEx("ShadowBallFXX",0,0,8,random(-10,10),random(-10,10),random(5,15),0,0,0)
BOMB AAAA 0 A_SpawnItemEx("SBallDeathFX",0,0,4,random(-13,13),random(-13,13),random(5,15),0,0,0)
BOMB A 0 A_PlaySoundEx("weapon/hyperbomb","Weapon")
BOMB A 0 A_Explode(5,100,0)
ASEX AB 3
BOMB AAAAAAAAAA 0 A_SpawnItemEx("ShadowBallFXX",0,0,8,random(-10,10),random(-10,10),random(5,15),0,0,0)
BOMB AAAAAA 0 A_SpawnItemEx("SBallDeathFX",0,0,4,random(-13,13),random(-13,13),random(5,15),0,0,0)
BOMB A 0 A_PlaySoundEx("weapon/hyperbomb","Weapon")
BOMB A 0 A_Explode(8,125,0)
ASEX CD 3
BOMB AAAAAAAAAA 0 A_SpawnItemEx("ShadowBallFXX",0,0,8,random(-10,10),random(-10,10),random(5,15),0,0,0)
BOMB AAAAAAAA 0 A_SpawnItemEx("SBallDeathFX",0,0,4,random(-13,13),random(-13,13),random(5,15),0,0,0)
BOMB A 0 A_PlaySoundEx("weapon/hyperbomb","Weapon")
BOMB A 0 A_Explode(10,150,0,0,25)
ASEX EF 3 
stop
}
}

actor ShadowBallFX
{
+NOINTERACTION
+CLIENTSIDEONLY
Scale 2.5
States
{
Spawn:
SDB2 A 0
SDB2 CDB 1 A_FadeOut(0.15)
stop
}
}

actor ShadowBallFXX
{
+NOINTERACTION
+CLIENTSIDEONLY
Radius 3
Height 3
+NOGRAVITY
Translation "209:215=6:6", "208:208=63:63", "4:4=63:63"
renderstyle "Add"
alpha 0.95
-SOLID
Scale 3.5 //2.5
States
{
Spawn:
MMFX A 0
MMFX BCDCBCDE 2 A_FadeOut(0.02) //1 tic
stop
}
}

actor DarkPulseMain
{
PROJECTILE
+NOTARGETSWITCH //I have to put this in just in case
//+SKYEXPLODE
Radius 20
Height 20
scale 3
Renderstyle "Translucent"
Alpha 0.8
Damage(10)
Translation "209:248=6:6", "208:208=63:63", "4:4=63:63", "168:168=63:63", "4:4=63:63"
Damagetype "DarkPulse"
Obituary "Well, at least %o didn't have to put up with %k's Dark Pulse Danmaku."
speed 35
States
{
Spawn:
GAMA U 0
GAMA UUVVWW 1 A_SpawnItemEx("DarkPulseTrail") 
goto Spawn+1
Death:
TNT1 A 0 A_PlaySoundEx("weapon/wrapfire","Voice")
TNT1 A 0 A_Explode(15,175,0)
TNT1 AAA 0 A_SpawnItemEx("LingeringDarkness",0,0,0,random(-15,15),random(-12,12),random(-8,8),random(0,359))
TNT1 A 0 A_SpawnItemEx("LingeringDarkness",0,0,5,15,0,0,0)
TNT1 A 0 A_SpawnItemEx("LingeringDarkness",0,0,5,15,0,0,36)
TNT1 A 0 A_SpawnItemEx("LingeringDarkness",0,0,5,15,0,0,72)
TNT1 A 0 A_SpawnItemEx("LingeringDarkness",0,0,5,15,0,0,108)
TNT1 A 0 A_SpawnItemEx("LingeringDarkness",0,0,5,15,0,0,144)
TNT1 A 0 A_SpawnItemEx("LingeringDarkness",0,0,5,15,0,0,180)
TNT1 A 0 A_SpawnItemEx("LingeringDarkness",0,0,5,15,0,0,216)
TNT1 A 0 A_SpawnItemEx("LingeringDarkness",0,0,5,15,0,0,252)
TNT1 A 0 A_SpawnItemEx("LingeringDarkness",0,0,5,15,0,0,288)
TNT1 A 1 A_SpawnItemEx("LingeringDarkness",0,0,5,15,0,0,324)
stop
}
}

actor DarkPulseTrail
{
Translation "209:248=6:6", "208:208=63:63", "4:4=63:63", "168:168=63:63", "4:4=63:63"
+NOINTERACTION
+CLIENTSIDEONLY
+NONETID
Scale 2.0
States
{
Spawn:
GAMA VW 2 A_FadeOut(0.2)
wait
}
}

actor LingeringDarkness
{
PROJECTILE
+HEXENBOUNCE
-BOUNCEONACTORS
+BOUNCEONCEILINGS
Obituary "%o was dispersed into the darkness by %k's Dark Pulse attack."
Radius 12
Height 12
Damage(3)
Damagetype "DarkType"
Translation "209:248=6:6", "208:208=63:63", "4:4=63:63", "168:168=63:63", "4:4=63:63"
WallBounceFactor 0.95
BounceFactor 0.95
Bouncecount 5
ReactionTime 15
scale 2.5
States
{
Spawn:
GAMA U 0
GAMA UV 2
GAMA U 0 A_Jump(192,"CountingDown")
GAMA W 2
goto Spawn+1
CountingDown:
GAMA W 2 A_Countdown
goto Spawn+1
Death:
TNT1 A 0
TNT1 A 0 A_PlaySoundEx("weapon/rminestick","Weapon")
TNT1 A 0 A_Explode(3,85,0)
MMFX BCDE 2
stop 
}
}

actor SwiftDarkMagicStarFX
{
Translation "220:223=6:6", "209:215=63:63"
+NOINTERACTION
+CLIENTSIDEONLY
Radius 4
Height 4
+NOGRAVITY
Scale 2.0
renderstyle "Translucent"
alpha 0.95
-SOLID
States
{
Spawn:
KIRC ABCDABCD 1 A_FadeOut(0.08)
stop
}
}

actor FeintAttackDamager
{
PROJECTILE
+DONTBLAST
+DONTSPLASH
+THRUGHOST
+DONTREFLECT
+RIPPER
-SOLID
height 16
radius 16
damage (0)
Damagetype "BNNormal"
Obituary "%o didn't avoid %k's Feint Attack in time."
States
{
Spawn:
TNT1 A 0
TNT1 A 1 A_Explode(5,150,0)
stop
}
}

actor FeintAttackBigDamager : FeintAttackDamager
{
height 24
radius 24
States
{
Spawn:
TNT1 A 0
TNT1 A 1 A_Explode(10,250,0)
stop
}
}

actor FeintAttackEnergy : Ammo
{
inventory.amount 1
inventory.maxamount 100
+INVENTORY.IGNORESKILL
}

actor SBallDeathFX2 : SBallDeathFX
{
-NOINTERACTION
Alpha 1.0
scale 1.0
States
{
Spawn:
FSWD D 0
FSWD D 2 bright A_ScaleVelocity(0.85)
FSWD D 0 A_SetTranslucent(0.8)
FSWD E 2 bright A_ScaleVelocity(0.85)
FSWD D 0 A_SetTranslucent(0.6)
FSWD F 2 bright A_ScaleVelocity(0.85)
FSWD D 0 A_SetTranslucent(0.4)
FSWD D 2 bright A_ScaleVelocity(0.85)
FSWD D 0 A_SetTranslucent(0.2)
FSWD E 2 bright A_ScaleVelocity(0.85)
FSWD D 0 A_SetTranslucent(0.4)
FSWD F 2 bright A_ScaleVelocity(0.85)
FSWD D 0 A_SetTranslucent(0.6)
FSWD D 2 bright A_ScaleVelocity(0.85)
FSWD D 0 A_SetTranslucent(0.8)
FSWD E 2 bright A_ScaleVelocity(0.85)
FSWD D 0 A_SetTranslucent(1.0)
FSWD F 2 bright A_ScaleVelocity(0.85)
stop
}
}

Actor VoidFallStartFX2
{
+CLIENTSIDEONLY
-SOLID
+NOINTERACTION
Radius 4
Height 4
Scale 1.0
States
{
Spawn:
TNT1 A 0
TNT1 AAAAAAAAAAAAAAAAAAAAAAAAA 1 A_SpawnItemEx("VoidDarknessFX",0,0,0,random(-20,20),random(-20,20),random(1,20),0,SXF_NOCHECKPOSITION|SXF_TRANSFERPOINTERS)
TNT1 A 85
stop
}
}

Actor VoidDarknessFX
{
+CLIENTSIDEONLY
-SOLID
+NOINTERACTION
+NOTARGETSWITCH
+FORCEXYBILLBOARD
Translation "248:248=254:254", "41:41=0:0"
Radius 4
Height 4
Renderstyle "Translucent"
Alpha 0.8
Scale 1.75
States
{
Spawn:
TNT1 A 0
FSWD D 0 A_JumpIfInventory("CutterFlag",4,"SendBack")
FSWD DEF 2 A_ScaleVelocity(0.75)
FSWD D 0 A_GiveInventory("CutterFlag",1)
goto Spawn+1
SendBack:
FSWD D 0 A_Stop
FSWD D 1 A_FaceTarget
FSWD D 0 A_CustomMissile("VoidDarknessFX2",0,0,0,0)
stop
Death:
TNT1 A 0
stop
}
}

Actor VoidDarknessFX2 : EvilRoboFistChargeFX
{
Translation "248:248=254:254", "41:41=0:0"
Renderstyle "Translucent"
Alpha 0.75
Speed 45
States
{
Spawn:
TNT1 A 0
FSWD DDEEFF 1 A_JumpIfCloser(24,"Death")
goto Spawn+1
Death:
TNT1 A 0
stop
}
}