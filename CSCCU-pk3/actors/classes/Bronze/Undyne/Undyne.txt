actor Undyne : ClassBaseCSCC
{
player.displayname "Undyne"
//player.soundclass "Undynec"
Health 65
Player.MaxHealth 65
//Health 200
//Player.MaxHealth 200
player.forwardmove 0.6, 0.6
player.sidemove 0.58, 0.58
player.startitem "UndyneStats"
player.startitem "UndyneSelfDestructItem"
player.startitem "UndyneSelfDestruct", 1
states
{
Spawn:
UDYN A 0
UDYN B 1 A_JumpIfInventory("UndyingFlag",1,2)
UDYN A -1 A_JumpIfInventory("UndyingFlag",1,1)
UDYN J 1
UDYN I 1 A_JumpIf(CallACS("UndyingFlag_Count")<1,"Spawn")
wait
See:
UDYN BBBBBCCCCCDDDDDEEEEE 1 A_JumpIfInventory("UndyingFlag",1,"See2")
Goto Spawn
See2:
UDYN J 1
UDYN JJJJJKKKKKLLLLLMMMMM 1 A_JumpIf(CallACS("UndyingFlag_Count")<1,"See")
Goto Spawn
Missile:
UDYN FFFFFGGGG 1 A_JumpIfInventory("UndyingFlag",1,"Missile2")
goto Spawn
Missile2:
UDYN N 1
UDYN NNNNOOOO 1 A_JumpIf(CallACS("UndyingFlag_Count")<1,"Missile")
goto Spawn
ClassPain:
UDYN H 0 A_JumpIfInventory("UndyingFlag",1,"ClassPain2")
goto MegamanPain
ClassPain2:
UDYN P 0
goto MegamanPain
ClassDeath:
UDYN H 0 A_JumpIfInventory("UndyingFlag",1,"ClassDeath2")
goto MegamanDeath
ClassDeath2:
UDYN P 0
goto MegamanDeath
}
}

actor UndyneStats : CustomInventory
{
states
{
Pickup:
TNT1 A 0 A_TakeInventory("UndyingFlag",1)

TNT1 A 0 A_GiveInventory("UndyneSpearBoss",1)
TNT1 A 0 A_GiveInventory("UndyneSpearAmmo",999)
TNT1 A 0 A_TakeInventory("UndyingSpearBoss",1)
TNT1 A 0 A_SelectWeapon("UndyneSpearBoss")

TNT1 A 0 ACS_NamedExecuteWithResult("SetActorProperty_Fixed",APROP_SPEED,1,1)
TNT1 A 0 ACS_NamedExecuteWithResult("SetActorProperty_Int",APROP_SpawnHealth,65)

TNT1 A 0 A_TakeInventory("DecayFlag",1)

TNT1 A 0 A_GiveInventory("UndyneReviveReady",1)
stop
}
}

actor UndyingStats : CustomInventory
{
states
{
Pickup:
TNT1 A 0 A_GiveInventory("UndyingFlag",1)

TNT1 A 0 A_GiveInventory("UndyingSpearBoss",1)
TNT1 A 0 A_TakeInventory("UndyingPower",999)
TNT1 A 0 A_TakeInventory("UndyneSpearBoss",1)
TNT1 A 0 A_SelectWeapon("UndyingSpearBoss")

TNT1 A 0 ACS_NamedExecuteWithResult("SetActorProperty_Fixed",APROP_SPEED,2,5)
//TNT1 A 0 ACS_NamedExecuteWithResult("SetActorProperty_Int",APROP_SpawnHealth,150)
TNT1 A 0 ACS_NamedExecuteWithResult("SetActorProperty_Int",APROP_SpawnHealth,CallACS("Undyne_Min",50+30*CallACS("Undyne_Enemy_Vicinity_Count",1500,1),200))

TNT1 A 0 A_GiveInventory("DecayFlag",1)
TNT1 A 0 ACS_NamedExecuteAlways("Undyne_Decay_Script",0,5,35)

//TNT1 A 0 A_GiveInventory("UndyingMeterGainFlag",1) //given in undyingspearboss
stop
}
}

actor UndyingFlag : Inventory
{
inventory.amount 1
inventory.maxamount 1
}

actor UndyingMeterGainFlag : Inventory
{
inventory.amount 1
inventory.maxamount 1
}

actor DecayFlag : Inventory
{
inventory.amount 1
inventory.maxamount 1
}

actor DecayPickup : CustomInventory
{
states
{
Pickup:
TNT1 A 0 A_JumpIfHealthLower(2,"PickupNo")
TNT1 A 0 A_ChangeFlag("NOPAIN",1)
TNT1 A 0 DamageThing(1)
TNT1 A 0 A_SpawnItemEx("EdgeBurstChargeFX",random(50,-50),random(50,-50),random(50,-50),0,0,10)
TNT1 A 0 A_ChangeFlag("NOPAIN",0)
stop
PickupNo:
TNT1 A 0
stop
}
}

actor UndyneReviveReady : CustomInventory
{
states
{
Pickup:
TNT1 A 0 HealThing(1)
TNT1 A 0 SetPlayerProperty(0, 1, 16)
TNT1 A 0 ACS_NamedExecuteAlways("Undyne_Revive_Check",0)
stop
}
}

actor UndyneRevive : CustomInventory
{
states
{
Pickup:
TNT1 A 0 SetPlayerProperty(0, 0, 16)
TNT1 A 0 A_GiveInventory("UndyneReviving",1)
TNT1 A 0 A_GiveInventory("UndyneSelfDestruct",1)
TNT1 A 0 A_JumpIfInventory("UndyingFlag",1,"Pickup2")
TNT1 A 0 A_GiveInventory("UndyingStats",1)
goto PickupEnd
Pickup2:
TNT1 A 0 A_GiveInventory("UndyneStats",1)
PickupEnd:
TNT1 A 0 A_GiveInventory("Health",200)
//TNT1 A 0 HealThing(200)
stop
}
}

actor UndyingPower : Ammo
{
+INVENTORY.IGNORESKILL
inventory.amount 1
inventory.maxamount 200
}

actor UndyingMeterGainCheck : CustomInventory
{
states
{
Pickup:
TNT1 A 0 A_JumpIfInventory("UndyingMeterGainFlag",1,"Pickup2")
stop
Pickup2:
TNT1 A 0 A_JumpIfInventory("UndyingPower",200,"Pickup3")
stop
Pickup3:
TNT1 A 0 A_TakeInventory("UndyingMeterGainFlag",1)
TNT1 A 0 A_GiveInventory("UndyneReviveReady",1)
stop
}
}

actor UndyingSoulGainFX : BasicClientSide
{
PROJECTILE
+SEEKERMISSILE
speed 20
reactiontime 70
renderstyle translucent
alpha 0.5
states
{
Spawn:
HBAL C 0
HBAL C 0 A_RearrangePointers(AAPTR_DEFAULT,AAPTR_DEFAULT,AAPTR_TARGET)//Target >> Tracer
Spawn2:
HBAL CCCDDD 1 A_GiveInventory("UndyingSoulGainFXFunc",1)
loop
}
}

actor UndyingSoulGainFXFunc : CustomInventory
{
states
{
Pickup:
TNT1 A 0 A_JumpIfCloser(60,"Detonate")
TNT1 A 0 A_CountDown
TNT1 AA 0 A_SeekerMissile(90, 90, SMF_PRECISE) 
stop
Detonate:
TNT1 AAAAAAAAAA 0 A_CountDown
TNT1 AAAAAAAAAA 0 A_CountDown
TNT1 AAAAAAAAAA 0 A_CountDown
TNT1 AAAAAAAAAA 0 A_CountDown
TNT1 AAAAAAAAAA 0 A_CountDown
TNT1 AAAAAAAAAA 0 A_CountDown
TNT1 AAAAAAAAAA 0 A_CountDown
stop
}
}