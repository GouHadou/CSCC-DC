//Passive and items
actor SnailStart : CustomInventory //Spawn item, creates checker
{
+INVENTORY.AUTOACTIVATE
-COUNTITEM
states
{
Pickup:
TNT1 A 1 A_SpawnItemEx("SnailDude")
stop
}
}

actor BreederTrail : BuddyTrail
{
obituary "$OB_SNAILTRAIL"
damagetype "SlugFeet2" //Give victim the SuperSlugFeet item.
Height 5
Radius 18
States
{
Spawn:
SNTR B 20
stop
}
}

actor SnailDude //Activates passive sequence
{
+MISSILE
+NOINTERACTION
+DONTBLAST
states
{
Spawn:
TNT1 A 0
TNT1 A 4 A_Warp(AAPTR_TARGET,0,0,0,0)
TNT1 A 0 A_GiveToTarget("SnailzClimb0",1)
TNT1 A 0 ACS_NamedExecuteAlways("cscc_stillalive",0,0)
TNT1 A 4 A_Warp(AAPTR_TARGET,0,0,0,0)
TNT1 A 0 A_GiveToTarget("SnailzClimb0",1)
TNT1 A 0 ACS_NamedExecuteAlways("cscc_stillalive",0,0)
TNT1 A 0 A_JumpIf(z-floorz<=0,"FloorIt")
loop
FloorIt:
TNT1 A 0 ACS_NamedExecuteAlways("cscc_stillalive",0,0)
TNT1 A 0 A_JumpIfInTargetInventory("ShellterFlag",1,"Spawn")
TNT1 A 0 A_GiveToTarget("SnailCrawl",1)
goto Spawn
Begone:
TNT1 A 0
stop
}
}

actor SnailzClimb0 : CustomInventory //Spawns climber in the directions
{
+INVENTORY.AUTOACTIVATE
-COUNTITEM
states
{
Pickup:
TNT1 A 0 ACS_NamedExecuteAlways("snailz_climbchecker",0,0)
stop
}
}

actor SnailzClimb1 : CustomInventory //Spawns climber in the directions
{
+INVENTORY.AUTOACTIVATE
-COUNTITEM
states
{
Pickup:
TNT1 A 0 A_SpawnItemEx("SnailWallCheck",4,0,0)
stop
}
}
actor SnailzClimb2 : SnailzClimb1
{
states
{
Pickup:
TNT1 A 0 A_SpawnItemEx("SnailWallCheck",3,-3,0)
stop
}
}
actor SnailzClimb3 : SnailzClimb1
{
states
{
Pickup:
TNT1 A 0 A_SpawnItemEx("SnailWallCheck",0,-4,0)
stop
}
}
actor SnailzClimb4 : SnailzClimb1
{
states
{
Pickup:
TNT1 A 0 A_SpawnItemEx("SnailWallCheck",-3,-3,0)
stop
}
}
actor SnailzClimb5 : SnailzClimb1
{
states
{
Pickup:
TNT1 A 0 A_SpawnItemEx("SnailWallCheck",-4,0,0)
stop
}
}
actor SnailzClimb6 : SnailzClimb1
{
states
{
Pickup:
TNT1 A 0 A_SpawnItemEx("SnailWallCheck",-3,3,0)
stop
}
}
actor SnailzClimb7 : SnailzClimb1
{
states
{
Pickup:
TNT1 A 0 A_SpawnItemEx("SnailWallCheck",0,4,0)
stop
}
}
actor SnailzClimb8 : SnailzClimb1
{
states
{
Pickup:
TNT1 A 0 A_SpawnItemEx("SnailWallCheck",3,3,0)
stop
}
}

actor SnailWallCheck //Wall checker
{
+MISSILE
+DONTBLAST
+NOGRAVITY
damage (0)
radius 14
height 50
states
{
Spawn:
TNT1 A 0
TNT1 AA 2
stop
Death:
TNT1 A 0 A_GiveToTarget("SnailClimb",1)
stop
}
}
actor SnailClimb : CustomInventory //Climb up
{
+INVENTORY.AUTOACTIVATE
-COUNTITEM
states
{
Pickup:
TNT1 A 0 A_JumpIfInventory("ShellterFlag",1,2)
TNT1 A 0 ThrustThingZ(0,8,0,0)
TNT1 A 0
stop
}
}

actor SnailCrawl : CustomInventory //Trail spawner
{
+INVENTORY.AUTOACTIVATE
-COUNTITEM
states
{
Pickup:
TNT1 A 1 ACS_NamedExecuteAlways("snailz_trailchecker",0,0)
stop
}
}
actor YesToTrail : CustomInventory //Trail spawner
{
+INVENTORY.AUTOACTIVATE
-COUNTITEM
states
{
Pickup:
TNT1 A 3
TNT1 A 0 A_SpawnItemEx("BreederTrail")
TNT1 A 0 A_PlaySoundEx("weapon/OilSlider","Voice")
stop
}
}

actor ShellterFlag : Inventory //Shell is present. Nuff said
{
inventory.amount 1
inventory.maxamount 1
}

actor ShellterCall : CustomInventory //Shell item
{
inventory.amount 1
inventory.maxamount 1
inventory.pickupmessage "$PU_SNAILSHELL"
inventory.icon "RCOIL"
Tag "$TAG_SNAILSHELL"
inventory.icon "SNELICO3"
scale 2.0
+COUNTITEM
+INVBAR
states
{
Spawn:
TNT1 A 0
stop
Use:
TNT1 A 0 A_JumpIfInventory("ShellAmmo",0,1)
goto NoUse
TNT1 A 0 A_JumpIf(z-floorz>0,"NoUse")
TNT1 A 0 A_JumpIfInventory("ShellterFlag",1,"NoUse")
TNT1 A 0 A_PlaySoundEx("item/refill","Voice")
TNT1 A 0 A_SpawnItemEx("Shellter",0,0,1)
TNT1 A 0 A_GiveInventory("ShellterFlag",1)
TNT1 A 0 A_Stop
TNT1 A 0 ACS_NamedExecuteAlways("snailz_heavystatue",0,1)
TNT1 A 0 A_ChangeFlag("NODAMAGETHRUST",1)
TNT1 A 0 ACS_NamedExecuteAlways("snailz_shellchecker",0,0)
TNT1 A 0 ACS_NamedExecuteAlways("core_freezeplayer",0,0,1)
TNT1 A 1
fail
NoUse:
TNT1 A 1 ACS_Execute(979,0)
fail
}
}

actor Shellter
{
+MISSILE
-SHOOTABLE
-SOLID
+THRUACTORS
+NOTARGETSWITCH
+NOGRAVITY
+NOTELEPORT
+NOTARGETSWITCH
+THRUSPECIES
+DONTRIP
+DONTSPLASH
+FLOORCLIP
//+REFLECTIVE
+DONTREFLECT
+NODAMAGETHRUST
//+DONTTHRUST 
+DONTBLAST
+GHOST
damage (0)
health 100
painchance 256
mass 999999
radius 50
height 60
bloodtype ""
scale 2.5
states
{
Spawn:
TNT1 A 0
TNT1 A 5
TNT1 A 0 A_PlaySoundEx("weapon/adapterreturn","Voice")
TNT1 A 0 A_TakeFromTarget("ShellAmmo",0)
TNT1 A 1 A_ChangeFlag("THRUACTORS",0)
TNT1 A 1 A_ChangeFlag("SOLID",1)
TNT1 A 1 A_ChangeFlag("SHOOTABLE",1)
TNT1 A 0 A_GiveInventory("CutterFlag",1)
SpawnCont:
SNSH A 2
SNSH A 0 A_JumpIfInTargetInventory("ShellterFlag",1,"SpawnCont")
goto Vanish
Pain:
TNT1 A 2 A_SpawnItemEx("PainFX",random(-5,5),random(-5,5),random(3,8))
TNT1 A 0 A_PlaySound("item/protoreflect","Weapon")
goto SpawnCont
Death:
TNT1 A 0 A_JumpIfInventory("CutterFlag",1,1)
goto Vanish
TNT1 A 0 A_PlaySoundEx("weapon/napalm","Weapon")
TNT1 A 0 A_SpawnItemEX("ShellterBit",random(-48,48),random(-48,48),random(0,40),random(-5,5),random(-5,5),random(0,5))
TNT1 A 0 A_SpawnItemEX("ShellterBit",random(-48,48),random(-48,48),random(0,40),random(-5,5),random(-5,5),random(0,5))
TNT1 A 0 A_SpawnItemEX("ShellterBit",random(-48,48),random(-48,48),random(0,40),random(-5,5),random(-5,5),random(0,5))
TNT1 A 0 A_SpawnItemEX("ShellterBit",random(-48,48),random(-48,48),random(0,40),random(-5,5),random(-5,5),random(0,5))
TNT1 A 0 A_SpawnItemEX("ShellterBit",random(-48,48),random(-48,48),random(0,40),random(-5,5),random(-5,5),random(0,5))
TNT1 A 0 A_SpawnItemEX("ShellterBit",random(-48,48),random(-48,48),random(0,40),random(-5,5),random(-5,5),random(0,5))
TNT1 A 0 A_SpawnItemEX("ShellterBit",random(-48,48),random(-48,48),random(0,40),random(-5,5),random(-5,5),random(0,5))
TNT1 A 0 A_SpawnItemEX("ShellterBit",random(-48,48),random(-48,48),random(0,40),random(-5,5),random(-5,5),random(0,5))
TNT1 A 0 A_SpawnItemEX("ShellterBit",random(-48,48),random(-48,48),random(0,40),random(-5,5),random(-5,5),random(0,5))
TNT1 A 0 A_SpawnItemEX("ShellterBit",random(-48,48),random(-48,48),random(0,40),random(-5,5),random(-5,5),random(0,5))
Vanish:
TNT1 A 1 A_ChangeFlag("SOLID",0)
TNT1 A 0 A_TakeFromTarget("ShellterFlag",1)
stop
}
}

actor ShellterBit
{
PROJECTILE
Damage (9)
obituary "$OB_SNAILSHELL"
damagetype "SnailShell"
Translation "198:198=110:110"
Height 5
Radius 5
-NOGRAVITY
Scale 2.0
speed 0
States
{
Spawn:
SNSH B 5
loop
}
}

actor LightenSnail : CustomInventory //Return knockback when Shellter is removed
{
+INVENTORY.AUTOACTIVATE
-COUNTITEM
states
{
Pickup:
TNT1 A 0
TNT1 A 0 A_ChangeFlag("NODAMAGETHRUST",0)
stop
}
}