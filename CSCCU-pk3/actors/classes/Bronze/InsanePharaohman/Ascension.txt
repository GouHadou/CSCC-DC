//+[==ASCENSION==]+

actor AscensionTech : CrazyWaveBoss
{
Weapon.AmmoUse 1
Weapon.SlotNumber 5
Obituary "You're not supposed to die from this you fucking donut."
Tag "$TAG_ASCENSION"
inventory.icon "ASCEN0"
States
{
Deselect:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Lower
IPID A 1 A_Lower
Loop
Select:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
IPID A 1 A_Raise
Loop

Fire:
TNT1 A 0 A_GiveInventory("AscensionBall",1) 
TNT1 A 0 A_PlaySoundEx("Ascension/Draw","Weapon")
TNT1 A 1 Offset(0,130) A_GunFlash
ASCA C 1 Offset(0,90)
ASCA C 1 Offset(0,50)
ASCA C 1 Offset(0,30)
ASCA C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
ASCA C 1 Offset(-4,28)
ASCA C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
ASCA C 1 Offset(4,36)
ASCA C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
ASCA C 1 Offset(-4,36)
ASCA C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
ASCA C 1 Offset(4,28)
ASCA C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
ASCA C 1 Offset(-4,28)
ASCA C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
ASCA C 1 Offset(4,36)
ASCA C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
ASCA C 1 Offset(-4,36)
ASCA C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
ASCA C 1 Offset(4,28)
ASCA C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
ASCA C 1 Offset(-4,28)
ASCA C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
ASCA C 1 Offset(4,36)
ASCA C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
ASCA C 1 Offset(-4,36)
ASCA C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
ASCA C 1 Offset(4,28)
ASCA C 1 A_WeaponReady(WRF_NOFIRE|WRF_NOSWITCH)
ASCA D 0 A_GiveInventory("CrazyWaveBossUp",1) 
IPID A 0 A_TakeInventory("CrazyWaveBoss",99)
ASCA D 0  A_GiveInventory("AscensionOnPickup",1) 
ASCA D 0  A_GiveInventory("AscensionEffect",1) 
ASCA D 1 A_TakeInventory("AscensionBall",1) 
TNT1 A 0 A_PlaySoundEx("Ascension/Absorb","Weapon")
TNT1 A 0 A_PlaySoundEx("Ascension/Banter","Body")
ASCA D 2 Offset(0,32)
ASCA E 2 Offset(0,34)
ASCA F 2 Offset(0,36)
ASCA G 2 Offset(0,38)
ASCA H 2 Offset(0,40)
ASCA I 2 Offset(0,42)
ASCA J 10
ASCA J 1 Offset(0,50)
ASCA J 1 Offset(0,90)
ASCA J 1 Offset(0,130)
TNT1 A 1
TakeAll:
ASCA D 0 A_SelectWeapon("CrazyWaveBossUp") 
IPID A 0 A_TakeInventory("AscensionTech",1)
IPID A 0 A_TakeInventory("AscensionAmmo",99)
Goto Ready1

Altfire:
IPID A 1 A_GiveInventory("CantSell",1) 
Goto Ready1

Flash:
TNT1 A 1 A_JumpIfInventory("AscensionBall",1,"Flash_1")
loop
Flash_1:
ASCO A 1 Offset(0,140)
ASCO B 1 Offset(0,100)
ASCO C 1 Offset(0,60)
ASCO A 1 Offset(0,40)
TNT1 A 1
goto Flash
}
}

actor AscensionOnPickup : CustomInventory
{
States
{
Pickup:
TNT1 A 0 A_SpawnItemEx("AscensionFXBeginHelper",0,0,28,0,0,0,0,1)
stop
}
}

actor AscensionFX : BasicClientSide
{
renderstyle add
speed 0
alpha 1
Scale 1.5
States
{
Spawn:
ASFX RST 1 A_FadeOut(0.2)
wait
}
}

actor AscensionFXBeginHelper : BasicHelper
{
States
{
Spawn:
TNT1 A 0
TNT1 A 1 A_SpawnItemEx("AscensionFXBegin",0,0,0,0,0,0,0,1)
stop
}
}

actor AscensionFXBegin : BasicClientSide
{
var int user_A;
reactiontime 30
States
{
Spawn:
TNT1 A 0
TNT1 A 0 A_SetUserVar("user_A",random(0,20))
TNT1 A 0 A_SpawnItemEx("AscensionFX",30,momx,10+momy,5+momz,0,10,user_A+5,37)
TNT1 A 0 A_SpawnItemEx("AscensionFX",40,momx,momy,10+momz,0,0,user_A,37)
TNT1 A 0 A_SpawnItemEx("AscensionFX",30,momx,-10+momy,5+momz,0,20,user_A+5,37)
TNT1 A 0 A_SetUserVar("user_A",user_A+20)
TNT1 A 0 A_Countdown
goto Spawn+2
Death:
TNT1 A 0

stop
}
}


ACTOR AscensionEffect : PowerupGiver
{
	+INVENTORY.AUTOACTIVATE
	+INVENTORY.ALWAYSPICKUP
	Inventory.MaxAmount 0
	Powerup.Type AscensionEffectScreen
    Powerup.Color 130 255 255 0.3
	States
	{
	Spawn:
		TNT1 A 1
		Loop
	}
}

actor PowerAscensionEffectScreen : Powerup
{
Powerup.Duration 30
inventory.amount 0
}

actor AscensionAmmo : Ammo
{
inventory.amount 1
inventory.maxamount 1
}

actor AscensionBall : Inventory
{
inventory.amount 1
inventory.maxamount 1
}

actor AscensionFlag : Inventory{}
