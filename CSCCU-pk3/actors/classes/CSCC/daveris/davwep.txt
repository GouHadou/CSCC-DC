actor DaverisClassWep : MegaBuster 
{
Weapon.AmmoUse 4
Weapon.AmmoGive 28
Weapon.SlotNumber 5
weapon.ammotype "PulseAmmo"
Obituary "%o was suddenly frozen by %k's Ice Shards."
Inventory.Pickupmessage "Power Up! Ice Slasher!"
inventory.pickupsound "weapon/weaponup"
+WEAPON.AMMO_OPTIONAL
+INVENTORY.UNDROPPABLE
+WEAPON.CHEATNOTWEAPON
inventory.icon "TNT1A0"
DropItem "IceSlasherWep"
Scale 2.0
States
{
Ready:
BLUH A 0 ACS_ExecuteAlways(998,0,WCCS_DAVERIS) 
BLUH A 2 A_WeaponReady(WRF_NOSWITCH)
BLUH A 0 A_GiveInventory("PulseAmmo", 1)
BLUH A 0 A_GiveInventory("FlurryAmmo", 1)
Goto Ready+1
Deselect:
TNT1 A 0 A_SelectWeapon("DaverisClassWep")
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Lower
TNT1 A 1 A_Lower
Loop
Select:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
BLUH A 1 A_Raise
Loop
Fire:
BLUH A 0 A_JumpIfInventory("IsBot", 1, "BotFire")
BLUH A 1 A_JumpIfNoAmmo("NoAmmo")
BLUH C 0 A_JumpIfInventory("ShardFlag",3,"Shot4")
BLUH C 0 A_JumpIfInventory("ShardFlag",2,"Shot3")
BLUH C 0 A_JumpIfInventory("ShardFlag",1,"Shot2")
BLUH C 0 A_PlaySoundEx("weapon/mbuster","Weapon")
BLUH C 0 A_FireCustomMissile ("IceShardShot", 0, 1, 0, 5)
BLUH C 11
BLUH C 1 A_WeaponReady(WRF_NOPRIMARY|WRF_NOSWITCH)
BLUH C 0 A_Refire
Goto Ready+1
Shot4:
BLUH C 0 A_PlaySoundEx("weapon/pshot","Weapon")
BLUH C 0 A_FireCustomMissile ("IceShard3", 0, 1, 0, 5)
BLUH C 11
BLUH C 1 A_WeaponReady(WRF_NOPRIMARY|WRF_NOSWITCH)
BLUH C 0 A_Refire
Goto Ready+1
Shot3:
BLUH C 0 A_PlaySoundEx("weapon/magnetmissile","Weapon")
BLUH C 0 A_FireCustomMissile ("IceShard2", 0, 1, 0, 5)
BLUH C 11
BLUH C 1 A_WeaponReady(WRF_NOPRIMARY|WRF_NOSWITCH)
BLUH C 0 A_Refire
Goto Ready+1
Shot2:
BLUH C 0 A_PlaySoundEx("weapon/iceslasher","Weapon")
BLUH C 0 A_FireCustomMissile ("IceShard1", 0, 1, 0, 5)
BLUH C 11
BLUH C 1 A_WeaponReady(WRF_NOPRIMARY|WRF_NOSWITCH)
BLUH C 0 A_Refire
Goto Ready+1
Altfire:
BLUH C 1 A_JumpIfInventory("FlurryAmmo",28,"Counter")
Goto NoAmmo
Counter:
BLUH C 0 A_JumpIfNoAmmo("NoAmmo")
BLUH C 0 SetPlayerProperty(0,1,0)
TNT1 A 0 A_ChangeFlag("SHOOTABLE",0)
BLUH C 20 A_SpawnItemEx("DaverisCounter")
BLUH C 0 A_TakeInventory("FlurryAmmo",28)
TNT1 A 0 A_ChangeFlag("SHOOTABLE",1)
BLUH C 0 SetPlayerProperty(0,0,0)
Goto Ready+1
NoAmmo:
BLUH A 1 ACS_Execute(979,0)
Goto Ready+1

BotFire:
BLUH C 0 A_JumpIfInventory("FlurryAmmo",28,"Counter")
BLUH A 0 A_GiveInventory("PulseAmmo", 4)
BLUH A 0 A_GiveInventory("FlurryAmmo", 4)
BLUH C 0 A_JumpIfInventory("ShardFlag",3,"Shot4")
BLUH C 0 A_JumpIfInventory("ShardFlag",2,"Shot3")
BLUH C 0 A_JumpIfInventory("ShardFlag",1,"Shot2")
BLUH C 0 A_PlaySoundEx("weapon/mbuster","Weapon")
BLUH C 0 A_FireCustomMissile ("IceShardShot", 0, 1, 0, 5)
BLUH C 11
BLUH C 1 A_WeaponReady(WRF_NOPRIMARY|WRF_NOSWITCH)
BLUH C 0 A_Refire
Goto Ready+1
}
}


actor IceShardShot 
{
Obituary "%o was suddenly frozen by %k's Ice Shards."
PROJECTILE
+LOOKALLAROUND
+DONTBLAST
Speed 100
damagetype "IcePulse"
Damage (1)
Radius 20
Height 20
scale 2.5
States
{
Spawn:
ICED A 7
Death:
TNT1 A 0 A_PlaySoundEx("weapon/icewavespawn","Voice")
TNT1 A 0 A_SpawnItemEx("IceShards",0,0,0,28,0,0,0)
TNT1 A 0 A_SpawnItemEx("IceShards",0,0,0,28,0,0,40)
TNT1 A 0 A_SpawnItemEx("IceShards",0,0,0,28,0,0,-40)
stop
}
}



actor IceShard1 
{
Obituary "%o was suddenly frozen by %k's Ice Shards."
PROJECTILE
+LOOKALLAROUND
+DONTBLAST
Speed 100
damagetype "IcePulse"
Damage (1)
Radius 20
Height 20
scale 2.5
States
{
Spawn:
ICED A 8
Death:
TNT1 A 0 A_PlaySoundEx("weapon/icewavespawn","Voice")
TNT1 A 0 A_SpawnItemEx("IceShards",0,0,0,28,0,0,0)
TNT1 A 0 A_SpawnItemEx("IceShards",0,0,0,28,0,0,30)
TNT1 A 0 A_SpawnItemEx("IceShards",0,0,0,28,0,0,-30)
stop
}
}



actor IceShard2 
{
Obituary "%o was suddenly frozen by %k's Ice Shards."
PROJECTILE
+LOOKALLAROUND
+DONTBLAST
Speed 100
damagetype "IcePulse"
Damage (1)
Radius 20
Height 20
scale 2.5
States
{
Spawn:
ICED A 8
Death:
TNT1 A 0 A_PlaySoundEx("weapon/icewavespawn","Voice")
TNT1 A 0 A_SpawnItemEx("IceShards",0,0,0,28,0,0,0)
TNT1 A 0 A_SpawnItemEx("IceShards",0,0,0,28,0,0,15)
TNT1 A 0 A_SpawnItemEx("IceShards",0,0,0,28,0,0,-15)
stop
}
}

actor IceShard3 
{
Obituary "%o was suddenly frozen by %k's Ice Shards."
PROJECTILE
+LOOKALLAROUND
+DONTBLAST
Speed 100
damagetype "IcePulse"
Damage (1)
Radius 20
Height 20
scale 2.5
States
{
Spawn:
ICED A 9
Death:
TNT1 A 0 A_PlaySoundEx("weapon/icewavespawn","Voice")
TNT1 A 0 A_SpawnItemEx("IceShards",0,0,0,28,0,0,0)
TNT1 A 0 A_SpawnItemEx("IceShards",0,0,0,28,0,0,10)
TNT1 A 0 A_SpawnItemEx("IceShards",0,0,0,28,0,0,-10)
stop
}
}

actor IceShards
{
Obituary "%o was suddenly frozen by %k's Ice Shards."
PROJECTILE
+RIPPER
+DONTBLAST
Radius 6
Height 6
scale 2.5
Speed 100
damagetype "IcePulse" 
damage (5)
States
{
Spawn:
ICES AB 3
loop
}
}

actor CoolestGuy
{
PROJECTILE
scale 2.5
+RIPPER
+DONTBLAST
Obituary "%o felt a lot cooler thanks to %k's Refrain Flurry."
Speed 22
damagetype "RefrainFlurry"
Radius 6
Height 6
Damage (2)
States
{
Spawn:
BLIZ C 35
stop
}
}

actor PulseAmmo : Ammo 
{
+INVENTORY.IGNORESKILL
inventory.amount 1
inventory.maxamount 28
}

actor FlurryAmmo : Ammo 
{
+INVENTORY.IGNORESKILL
inventory.amount 1
inventory.maxamount 28
}

actor DaverisCounter
{
+MISSILE
//+RIPPER
+DONTSPLASH
+SHOOTABLE
+GHOST
+NOGRAVITY
Damage 0
height 56
speed 0
health 9999
+DONTRIP
painchance 256
+NOBLOOD
+NOTARGETSWITCH
radius 40
scale 2.5
States
{
Spawn:
TNT1 A 20
stop
Pain:
TNT1 A 0 A_ChangeFlag("SHOOTABLE",0)
TNT1 A 0 A_ChangeFlag("NOINTERACTION",1)
TNT1 A 0 A_GiveToTarget("ShardFlag",1)
//TNT1 A 1 A_PlaySoundEx("weapon/centaurflash","Weapon")
TNT1 A 1 A_PlaySoundEx("weapon/icebreath","Weapon")
TNT1 A 0 A_GiveToTarget("DaverisCounterFlag",1)
TNT1 AAAAAAAAAAAAAAAAAAAA 3 A_GiveToTarget("DaverisCounterAttack",1)
stop
}
}

actor DaverisCounterAttack : CustomInventory
{
inventory.amount 1
inventory.maxamount 20
states
{
Spawn:
TNT1 A 0
stop
Pickup:
//TNT1 A 0 A_FireCustomMissile("IceFlurryLauncher",0,0,0,0)
TNT1 A 1 A_FireCustomMissile("CoolestGuy",random(-12,12),0,0,random(-7,7))
TNT1 A 2
stop
}
}


actor IceFlurryLauncher
{
scale 2.5
PROJECTILE
+RIPPER
-SOLID
-NOGRAVITY
+NOINTERACTION
damage (0)
radius 1
height 1
speed 0
states
{
Spawn:
TNT1 A 1 A_JumpIfInTargetInventory("FlurryAmmo",8,"Shoot")
Shoot:
TNT1 ABC 1 A_SpawnItemEx("CoolestGuy",5,0,15,random(10,15),random(-3,3),random(-1,1),0, 0, 0)
TNT1 A 0 A_GiveToTarget("IceFlurryFlag",1)
TNT1 A 0 A_JumpIfInTargetInventory("IceFlurryFlag",20,"StopFlurry")
loop
StopFlurry:
TNT1 A 0 A_TakeFromTarget("IceFlurryFlag",999)
TNT1 A 0 A_TakeFromTarget("FlurryAmmo",8)
stop
}
}


actor IceFlurryFlag : Ammo
{
inventory.amount 1
inventory.maxamount 120
}

actor ShardFlag: Inventory
{
inventory.amount 1
inventory.maxamount 5
}

actor DaverisCounterFlag : CustomInventory
{
inventory.amount 1
inventory.maxamount 1
+INVENTORY.UNDROPPABLE
+INVENTORY.AUTOACTIVATE
states
{
Spawn:
TNT1 A 0
stop
Use:
TNT1 A 0 SetPlayerProperty(0,1,0)
TNT1 A 0 SetPlayerProperty(0,1,4)
TNT1 A 60
TNT1 A 0 SetPlayerProperty(0,1,0)
TNT1 A 0 SetPlayerProperty(0,0,4)
stop
}
}
