actor Messatsu : ClassBaseCSCC
{
player.displayname "Messatsu"
player.soundclass "MessClass"
player.damagescreencolor "black"
player.forwardmove 1.0, 1.0
player.sidemove 1.0, 1.0
player.jumpz 13
Health 75
Player.MaxHealth 75
player.startitem "MessatsuWep"
player.startitem "TemaInv"
player.startitem "MisogiInv"
player.startitem "RagingDemonInv"
var int user_LastKnownHealth;
States
{
Spawn:
MTSU A 0
MTSU B 1
MTSU A 1 A_SetUserVar("user_LastKnownHealth", health)
Goto Spawn+2
See:
MTSU BCDE 5
Goto Spawn
Missile:
MTSU F 5 A_SetUserVar("user_LastKnownHealth", health)
MTSU G 4
goto Spawn
Pain.CopyAlt:
Pain.CopyMain:
MTSU H 0 A_SpawnItemEx("MessCopyHitMain",1)
goto pain+1
ClassPain:
MTSU H 0
MTSU H 0 A_JumpIfInventory("GravityHoldPainPower",1,"GravityHoldWait")
MTSU H 0 A_JumpIfInventory("WilyIcePainPower",1,"WilyIceWait")
MTSU H 0 A_Pain
//MTSU H 0 A_JumpIfInventory("MessatsuSpamFlag", 1,3)
//MTSU H 0 A_GiveInventory("MessatsuSpamFlag", 1)
MTSU H 0 A_TakeInventory("MessChargeLimit", 999)
MTSU H 0 A_GiveInventory("MessatsuAmmo",(user_LastKnownHealth - health)/3)
MTSU H 0 A_SetUserVar("user_LastKnownHealth", health)
MTSU H 1 A_SpawnItemEx("PainFX",-5,0,3,0,0,0)
MTSU H 1 A_Recoil(1)
MTSU HHHHHHHHH 2 A_SpawnItemEx("PainFX",-5,0,3,0,0,0)
MTSU H 1
goto SuperSpawn
}
}
/*
actor MessatsuSpamFlag : PowerUp
{
Powerup.Duration 3
}
*/
actor RagingDemonInv : CustomInventory 
{
inventory.amount 1
inventory.maxamount 1
inventory.icon "RDEMON"
Inventory.PickupSound "item/1up"
+INVBAR
+COUNTITEM
scale 2.0
States
{
Spawn:
SGST A 1 
loop
Use:
SGST A 0 A_JumpIfInventory("MessatsuAmmo", 56, "Success")
fail
Success:
SGST A 0 A_TakeInventory("MessatsuAmmo", 56)
SGST A 0 A_GiveInventory("RagingDemonFlag", 1)
fail
Death:
TNT1 A 0
stop
}
}

actor MisogiInv : RagingDemonInv 
{
inventory.icon "MISOGI"
States
{
Use:
SGST A 0 A_JumpIfInventory("MessatsuAmmo", 36, "Success")
fail
Success:
SGST A 0 A_TakeInventory("MessatsuAmmo", 36)
SGST A 0 A_GiveInventory("MisogiFlag", 1)
fail
}
}

actor TemaInv : RagingDemonInv 
{
inventory.icon "TEMAGOU"
States
{
Use:
SGST A 0 A_JumpIfInventory("MessatsuAmmo", 18, "Success")
fail
Success:
SGST A 0 A_TakeInventory("MessatsuAmmo", 18)
SGST A 0 A_GiveInventory("TemaFlag", 1)
fail
}
}

actor MessCopyPickupMain : CustomInventory
{
inventory.amount 1
inventory.maxamount 1
States
{
Spawn:
TNT1 A 0
stop
Pickup:
TNT1 A 0 A_GiveToTarget("MessatsuMorphItem",1)
stop
}
}

actor MessCopyHitMain
{
Height 0
Radius 0
+NOINTERACTION
-SOLID
+NOGRAVITY
+MISSILE
States
{
Spawn:
TNT1 A 0
TNT1 A 0 A_GiveToTarget("MessCopyPickupMain",1)
stop
}
}


actor MessatsuMorphItem : CustomInventory
{
States
{
Spawn:
TNT1 A 0
stop
Pickup:
TNT1 A 0 ACS_ExecuteAlways(CSACS_COPYMORPH, 0, 19)
stop
}
}

actor MessatsuMorph : Messatsu
{
+NOSKIN
player.morphweapon "MessatsuWep"
player.soundclass "BestClassEver"
States
{
Pain:
YOKM H 0 A_ScaleVelocity(0.75)
YOKM H 0 
Goto "ClassBaseCSCC::Pain+2"
}
}