actor TsukiClassWeaponOld : Weapon
{
Weapon.SlotNumber 1
scale 2.0
Inventory.Pickupmessage "Power Up! Sentinel Wisps!"
weapon.ammotype2 "SentinelWispsClassAmmo"
+WEAPON.AMMO_OPTIONAL
+WEAPON.DONTBOB
+WEAPON.CHEATNOTWEAPON
+INVENTORY.UNDROPPABLE
inventory.icon "TNT1A0"
States
{
Spawn:
TSU0 Z 0
TSU0 Z 1 //A_SpawnItemEx("SentinelWispsWep")
stop
Ready:
TSU0 A 0 ACS_ExecuteAlways(998,0,0)
goto Ready2
Ready2:
TSU0 A 0 A_GiveInventory("SentinelWispsClassAmmo",1)
TSU0 A 1 A_WeaponReady(2)
loop
Deselect:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Lower
TNT1 A 1 A_Lower
Loop
Select:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
TSU0 A 1 A_Raise
Loop
Fire:
TSU0 A 0 A_PlaySoundEx("weapon/pharaoh2","Weapon")
TSU0 B 0 A_FireCustomMissile("HungryWisp",0,0)
TSU0 B 3
TSU0 A 12
goto Ready2
AltFire:
TSU0 A 0 A_JumpIfInventory("SentinelWispsClassAmmo",35,"SetMine1")
TSU0 B 3
TSU0 A 20
goto Ready2
SetMine1:
TSU0 A 0 A_JumpIfInventory("SentinelReady1",1,"SetMine2")
TSU0 B 0 A_FireCustomMissile("FakeSentinelFlame",0,0)
TSU0 B 0 A_FireCustomMissile("SentinelWispMine1",0,0)
TSU0 B 0 A_TakeInventory("SentinelWispsClassAmmo",35)
goto AltFire+1
SetMine2:
TSU0 A 0 A_JumpIfInventory("SentinelReady2",1,"SetMine3")
TSU0 B 0 A_FireCustomMissile("FakeSentinelFlame",0,0)
TSU0 B 0 A_FireCustomMissile("SentinelWispMine2",0,0)
TSU0 B 0 A_TakeInventory("SentinelWispsClassAmmo",35)
goto AltFire+1
SetMine3:
TSU0 A 0 A_JumpIfInventory("SentinelReady3",1,"SetMine4")
TSU0 B 0 A_FireCustomMissile("FakeSentinelFlame",0,0)
TSU0 B 0 A_FireCustomMissile("SentinelWispMine3",0,0)
TSU0 B 0 A_TakeInventory("SentinelWispsClassAmmo",35)
goto AltFire+1
SetMine4:
TSU0 A 0 A_JumpIfInventory("SentinelReady4",1,"NoSet")
TSU0 B 0 A_FireCustomMissile("FakeSentinelFlame",0,0)
TSU0 B 0 A_FireCustomMissile("SentinelWispMine4",0,0)
TSU0 B 0 A_TakeInventory("SentinelWispsClassAmmo",35)
goto AltFire+1
NoSet:
goto AltFire+1
}
}

actor SentinelWispsClassAmmo : Ammo
{
+INVENTORY.IGNORESKILL
inventory.amount 1
inventory.maxamount 140
}

actor HungryWisp : FastProjectileBase
{
PROJECTILE
+LOOKALLAROUND
+SKYEXPLODE
+FORCEXYBILLBOARD //NEVER leave this flag out of the projectiles.
+DONTBLAST //Removing this decreases the chance of fighting against leaf shield and the like.
Radius 5
Height 5
Obituary "%o was carried away by %k's Hungry Wisps."
scale 2.5
damage (10)
damagetype "Skull"
speed 80
States
{
Spawn:
TSU0 IJKLMN 2
loop
Death:
TSU0 OPQ 2
stop
}
}

actor SentinelWispMine1
{
PROJECTILE
+MTHRUSPECIES
+LOOKALLAROUND
+RIPPER
+SKYEXPLODE
+FORCEXYBILLBOARD
+PAINLESS 
+DONTBLAST 
Renderstyle None
Alpha 0.1
Radius 7
Height 7
scale 2.5
damage (0)
damagetype "Dummy"
Obituary "%o was consumed by %k's Sentinel Wisp."
speed 0
States
{
Spawn:
TSU0 X 1
TSU0 X 0 A_GiveInventory("SentinelWallFlag",1)
TSU0 X 0 A_PlaySoundEx("weapon/tsukisentinel", "voice", 0)
TSU0 X 0 A_JumpIfInTargetInventory("SentinelReady1",1,"Waiting1")
TSU0 X 0 A_JumpIfInTargetInventory("IsTsukiAndIsAlive",1,"SettingUp")
goto XDeath
SettingUp:
TSU0 X 1 A_GiveInventory("SentinelCountFlag",1)
TSU0 X 0 A_JumpIfInventory("SentinelCountFlag",12,"Waiting1")
TSU0 X 0 A_JumpIfInTargetInventory("IsTsukiAndIsAlive",1,"SettingUp")
goto XDeath
Waiting1:
TSU0 O 1 A_Changeflag("RIPPER",0)
TSU0 O 0 A_GiveToTarget("SentinelReady1",1)
TSU0 O 0 A_JumpIfInTargetInventory("SentinelTrigger",1,"XDeath")
TSU0 O 0 A_JumpIfInTargetInventory("IsTsukiAndIsAlive",1,"Waiting2")
goto XDeath
Waiting2:
TSU0 P 1 A_Changeflag("RIPPER",0)
TSU0 P 0 A_GiveToTarget("SentinelReady1",1)
TSU0 P 0 A_JumpIfInTargetInventory("SentinelTrigger",1,"XDeath")
TSU0 P 0 A_JumpIfInTargetInventory("IsTsukiAndIsAlive",1,"Waiting3")
goto XDeath
Waiting3:
TSU0 Q 1 A_Changeflag("RIPPER",0)
TSU0 X 0 A_GiveToTarget("SentinelReady1",1)
TSU0 X 0 A_JumpIfInTargetInventory("SentinelTrigger",1,"XDeath")
TSU0 X 0 A_JumpIfInTargetInventory("IsTsukiAndIsAlive",1,"Waiting1")
goto XDeath
XDeath:
TSU0 X 1
TSU0 X 0 A_TakeFromTarget("SentinelReady1",1)
TSU0 X 0 A_TakeFromTarget("SentinelTrigger",1)
TSU0 X 0 A_PlaySoundEx("weapon/tsukisentinel","Voice")
TSU0 X 0 A_SpawnItemEx("FakeSentinelFlame",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
TSU0 X 12
TSU0 X 0 A_PlaySoundEx("weapon/pharaoh2","Voice")
TSU0 X 0 A_SpawnItemEx("SentinelFlames",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,0,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,45,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,90,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,135,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,180,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,-135,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,-90,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,-45,SXF_NOCHECKPOSITION)
stop
Death:
TSU0 X 0 A_JumpIfInventory("SentinelWallFlag",1,"XDeath")
TSU0 X 0 A_PlaySoundEx("weapon/tsukisentinel", "voice", 0)
Goto Spawn+3
}
}

actor SentinelWispMine2 : SentinelWispMine1
{
States
{
Spawn:
TSU0 X 1
TSU0 X 0 A_PlaySoundEx("weapon/tsukisentinel", "voice", 0)
TSU0 X 0 A_JumpIfInTargetInventory("SentinelReady2",1,"Waiting1")
TSU0 X 0 A_JumpIfInTargetInventory("IsTsukiAndIsAlive",1,"SettingUp")
goto XDeath
Waiting1:
TSU0 O 1 A_Changeflag("RIPPER",0)
TSU0 X 0 A_GiveToTarget("SentinelReady2",1)
TSU0 X 0 A_JumpIfInTargetInventory("SentinelTrigger",1,"XDeath")
TSU0 X 0 A_JumpIfInTargetInventory("IsTsukiAndIsAlive",1,"Waiting2")
goto XDeath
Waiting2:
TSU0 P 1 A_Changeflag("RIPPER",0)
TSU0 X 0 A_GiveToTarget("SentinelReady2",1)
TSU0 X 0 A_JumpIfInTargetInventory("SentinelTrigger",1,"XDeath")
TSU0 X 0 A_JumpIfInTargetInventory("IsTsukiAndIsAlive",1,"Waiting3")
goto XDeath
Waiting3:
TSU0 Q 1 A_Changeflag("RIPPER",0)
TSU0 X 0 A_GiveToTarget("SentinelReady2",1)
TSU0 X 0 A_JumpIfInTargetInventory("SentinelTrigger",1,"XDeath")
TSU0 X 0 A_JumpIfInTargetInventory("IsTsukiAndIsAlive",1,"Waiting1")
goto XDeath
XDeath:
TSU0 X 1
TSU0 X 0 A_TakeFromTarget("SentinelReady2",1)
TSU0 X 0 A_TakeFromTarget("SentinelTrigger",1)
TSU0 X 0 A_PlaySoundEx("weapon/tsukisentinel", "voice", 0)
TSU0 X 0 A_SpawnItemEx("FakeSentinelFlame",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
TSU0 X 12
TSU0 X 0 A_PlaySoundEx("weapon/pharaoh2","Voice")
TSU0 X 0 A_SpawnItemEx("SentinelFlames",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,0,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,45,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,90,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,135,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,180,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,-135,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,-90,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,-45,SXF_NOCHECKPOSITION)
stop
}
}

actor SentinelWispMine3 : SentinelWispMine1
{
States
{
Spawn:
TSU0 X 1
TSU0 X 0 A_GiveInventory("SentinelWallFlag",1)
TSU0 X 0 A_PlaySoundEx("weapon/tsukisentinel", "voice", 0)
TSU0 X 0 A_JumpIfInTargetInventory("SentinelReady3",1,"Waiting1")
TSU0 X 0 A_JumpIfInTargetInventory("IsTsukiAndIsAlive",1,"SettingUp")
goto XDeath
Waiting1:
TSU0 O 1 A_Changeflag("RIPPER",0)
TSU0 X 0 A_GiveToTarget("SentinelReady3",1)
TSU0 X 0 A_JumpIfInTargetInventory("SentinelTrigger",1,"XDeath")
TSU0 X 0 A_JumpIfInTargetInventory("IsTsukiAndIsAlive",1,"Waiting2")
goto XDeath
Waiting2:
TSU0 P 1 A_Changeflag("RIPPER",0)
TSU0 X 0 A_GiveToTarget("SentinelReady3",1)
TSU0 X 0 A_JumpIfInTargetInventory("SentinelTrigger",1,"XDeath")
TSU0 X 0 A_JumpIfInTargetInventory("IsTsukiAndIsAlive",1,"Waiting3")
goto XDeath
Waiting3:
TSU0 Q 1 A_Changeflag("RIPPER",0)
TSU0 X 0 A_GiveToTarget("SentinelReady3",1)
TSU0 X 0 A_JumpIfInTargetInventory("SentinelTrigger",1,"XDeath")
TSU0 X 0 A_JumpIfInTargetInventory("IsTsukiAndIsAlive",1,"Waiting1")
goto XDeath
XDeath:
TSU0 X 1
TSU0 X 0 A_TakeFromTarget("SentinelReady3",1)
TSU0 X 0 A_TakeFromTarget("SentinelTrigger",1)
TSU0 X 0 A_PlaySoundEx("weapon/tsukisentinel", "voice", 0)
TSU0 X 0 A_SpawnItemEx("FakeSentinelFlame",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
TSU0 X 12
TSU0 X 0 A_PlaySoundEx("weapon/pharaoh2","Voice")
TSU0 X 0 A_SpawnItemEx("SentinelFlames",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,0,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,45,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,90,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,135,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,180,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,-135,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,-90,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,-45,SXF_NOCHECKPOSITION)
stop
}
}

actor SentinelWispMine4 : SentinelWispMine1
{
States
{
Spawn:
TSU0 X 1
TSU0 X 0 A_GiveInventory("SentinelWallFlag",1)
TSU0 X 0 A_PlaySoundEx("weapon/tsukisentinel", "voice", 0)
TSU0 X 0 A_JumpIfInTargetInventory("SentinelReady4",1,"Waiting1")
TSU0 X 0 A_JumpIfInTargetInventory("IsTsukiAndIsAlive",1,"SettingUp")
goto XDeath
Waiting1:
TSU0 O 1 A_Changeflag("RIPPER",0)
TSU0 X 0 A_GiveToTarget("SentinelReady4",1)
TSU0 X 0 A_JumpIfInTargetInventory("SentinelTrigger",1,"XDeath")
TSU0 X 0 A_JumpIfInTargetInventory("IsTsukiAndIsAlive",1,"Waiting2")
goto XDeath
Waiting2:
TSU0 P 1 A_Changeflag("RIPPER",0)
TSU0 X 0 A_GiveToTarget("SentinelReady4",1)
TSU0 X 0 A_JumpIfInTargetInventory("SentinelTrigger",1,"XDeath")
TSU0 X 0 A_JumpIfInTargetInventory("IsTsukiAndIsAlive",1,"Waiting3")
goto XDeath
Waiting3:
TSU0 Q 1 A_Changeflag("RIPPER",0)
TSU0 X 0 A_GiveToTarget("SentinelReady4",1)
TSU0 X 0 A_JumpIfInTargetInventory("SentinelTrigger",1,"XDeath")
TSU0 X 0 A_JumpIfInTargetInventory("IsTsukiAndIsAlive",1,"Waiting1")
goto XDeath
XDeath:
TSU0 X 1
TSU0 X 0 A_TakeFromTarget("SentinelReady4",1)
TSU0 X 0 A_TakeFromTarget("SentinelTrigger",1)
TSU0 X 0 A_PlaySoundEx("weapon/tsukisentinel", "voice", 0)
TSU0 X 0 A_SpawnItemEx("FakeSentinelFlame",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
TSU0 X 12
TSU0 X 0 A_PlaySoundEx("weapon/pharaoh2","Voice")
TSU0 X 0 A_SpawnItemEx("SentinelFlames",0,0,0,0,0,0,0,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,0,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,45,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,90,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,135,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,180,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,-135,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,-90,SXF_NOCHECKPOSITION)
TSU0 X 0 A_SpawnItemEx("SentinelFlamesSpawner",0,0,0,32,0,0,-45,SXF_NOCHECKPOSITION)
stop
}
}

actor SentinelFlamesSpawner
{
PROJECTILE
+FORCEXYBILLBOARD
+SKYEXPLODE
+DONTBLAST
+NOINTERACTION
Radius 5
Height 5
scale 2.5 
damage (0)
speed 0
ReactionTime 3
States
{
Spawn:
TNT1 A 2
TNT1 A 0 A_SpawnItemEx("SentinelFlames",0,0,0,random(-32,0),random(-24,24),random(0,128),0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION)
TNT1 A 0 A_SpawnItemEx("SentinelFlames",0,0,0,random(-32,0),random(-24,24),random(-128,0),0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION)
TNT1 A 0 A_Countdown
loop
}
}

actor FakeSentinelFlame
{
PROJECTILE
+FORCEXYBILLBOARD
+SKYEXPLODE
+DONTBLAST
+NOINTERACTION
+NONETID
+CLIENTSIDEONLY
Radius 0
Height 0
scale 2.5 
damage (0)
speed 0
States
{
Spawn:
TSU0 CXCXDXDXEXEX 1 A_SetTranslucent(0.1, 0)
Stop
}
}

actor SentinelFlames
{
height 7
radius 7
PROJECTILE
+LOOKALLAROUND
+SKYEXPLODE
+FORCEXYBILLBOARD
+RIPPER
+DONTBLAST
+DOOMBOUNCE
+MTHRUSPECIES
bouncefactor 1.0
damage (5)
Obituary "%o was consumed by %k's Sentinel Wisp."
damagetype "Skull"
scale 2.5
Speed 32
States
{
Spawn:
TSU0 C 1
TSU0 C 0 A_Stop
TSU0 CDE 2
TSU0 D 0 A_ChangeFlag("NOINTERACTION",1)
TSU0 D 0 A_ChangeFlag("CLIENTSIDEONLY",1)
TSU0 D 0 A_ChangeFlag("NONETID",1)
TSU0 FGH 2
stop
}
}

actor SentinelWallFlag : Inventory
{
inventory.amount 1
inventory.maxamount 1
}

actor SentinelCountFlag : Inventory
{
inventory.amount 1
inventory.maxamount 12
}