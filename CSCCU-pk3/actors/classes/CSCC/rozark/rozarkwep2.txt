actor BloodyBatClass : BaseCSCCWep 
{
Weapon.AmmoUse 10
Weapon.AmmoGive 30
Weapon.SlotNumber 2
Obituary "%o's skull was cracked open by %k's Bloody Bat."
Inventory.Pickupmessage "Power up! Oblivion Wings!"
weapon.ammotype "OblivionWingsAmmo"
DropItem "BloodyBatWepGiver"
inventory.pickupsound "weapon/weaponup"
+WEAPON.AMMO_OPTIONAL
+WEAPON.CHEATNOTWEAPON
Scale 2.0
States
{
Ready:
ROZS A 0 A_JumpIfHealthLower(26, "ReadyInsanity")
ROZA A 0 ACS_ExecuteAlways(998,0,WCCS_ROZARK)
ROZS A 0 A_JumpIfHealthLower(26, "ReadyInsanity")
ROZS A 1 A_WeaponReady
Goto Ready+2
ReadyInsanity:
ROZS A 0 ACS_ExecuteAlways(998,0,77, 1)
ReadyInsanity2:
ROZS A 1 A_WeaponReady
ROZS A 0 A_JumpIfHealthLower(26, "ReadyInsanity2")
Goto Ready
Deselect:
TNT1 A 0 A_SelectWeapon("OblivionWingsClass")
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Lower
ROZS A 1 A_Lower
Loop
Select:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
ROZS A 1 A_Raise
Loop
Fire:
ROZS B 3 A_JumpIfInventory("IsBot", 1, "BotAlt")
TNT1 A 3 
ROZS C 2
ROZS B 0 
ROZS B 0 A_PlaySoundEx("Rozark/Sock","Weapon")
ROZS B 0 A_FireCustomMissile("SockSwing",0,0,8,0)
ROZA B 0 A_GiveInventory("Rozarkboomerangflag", 2)
ROZS DE 2
TNT1 A 3
ROZS A 4
ROZA B 0 A_Refire
Goto Ready+2
BotAlt:
ROZA A 0 A_Jump(8, "BotUsagi")
Goto Fire+1
BotUsagi:
ROZA A 0 A_TakeInventory("WeaponCharge", 999)
Goto UsagiStart
NoAmmo:
ROZS A 1 ACS_Execute(979,0)
Goto Ready+2

AltFire:
ROZA A 0 A_JumpIfInventory("OblivionWingsAmmo", 10, "UsagiCheck")
Goto NoAmmo
UsagiCheck:
ROZD A 2 A_FireCustomMissile("RozarkTracer",0,0,0,0)
ROZD A 0 A_Refire
ROZD A 0 A_TakeInventory("OblivionWingsAmmo", 10)
ROZD A 0 A_TakeInventory("RozarkFlag", 35) 
ROZD A 0 A_GiveInventory("Rozarkboomerangflag", 2)
ROZD A 0 ThrustThingZ(0,0,0,0)
UsagiStart:
ROZD B 0 A_ChangeFlag("THRUACTORS", 1)
ROZD B 0 A_ChangeFlag("NOGRAVITY", 1)
ROZD B 0 A_PlaySoundEx("weapon/chargekick","Weapon")
ROZD B 0 A_SetTranslucent(0.5)
ROZD B 0 ThrustThing(angle*256/360, Cos(pitch)*80, 1, 0)
ROZD B 0 ThrustThingZ(0, -sin(pitch)*320, 0, 1)
ROZD BBBCCC 1 A_SpawnItemEx("UsagiShadow", 16, 0, 16, momx/4, momy/4, momz, 0, SXF_ABSOLUTEMOMENTUM|SXF_TRANSFERTRANSLATION|SXF_NOCHECKPOSITION, 0)
ROZD C 0 A_ChangeFlag("NOGRAVITY", 0)
ROZD C 0 A_SetTranslucent(1.0)
ROZD C 0 A_ScaleVelocity(0.25)
ROZD C 0 A_SetArg(0, 0)
Goto SolidifyChecker
SolidifyChecker:
ROZD C 0 A_SetArg(0, Args[0]+1)
ROZD C 1 A_SpawnItemEx("DashChecker")
Goto UsagiEnd
UsagiEnd:
//ROZD C 0 A_ChangeFlag("SOLID", 1)
ROZD C 0 A_TakeInventory("CutterFlag", 100)
ROZD C 0 A_ClearRefire
ROZD C 1
ROZD BA 2
Goto Ready+2

Flash:
TNT1 H 5 A_PlaySoundEx("weapon/coilcharge", "Weapon")
TNT1 H 0 A_JumpIfInventory("WeaponCharge",1,"Flash")
stop
}
}


actor SockSwing
{
PROJECTILE
+MTHRUSPECIES
+DONTBLAST
Radius 16
Height 16
scale 2.5
Obituary "%o's skull was cracked open by %k's Bloody Bat."
speed 60
damage (0)
Damagetype "Sock"
States
{
Spawn:
TNT1 A 1
Goto Death
Death:
//TNT1 A 0 A_Explode(20, 40, 0, 0, 40)
TNT1 A 0 A_Explode(10, 40, 0, 0, 40)
stop
}
}


actor BloodDropSpawner : CustomInventory
{
inventory.amount 1
inventory.maxamount 1
+INVENTORY.AUTOACTIVATE
States
{
Spawn:
TNT1 A 1
loop
Use:
TNT1 A 1 A_SpawnItemEX("BloodDrop", random(-16,16), random(-16,16), random(0,32))
stop
}
}

actor BleedingFlag : BrightBlind
{
}

actor BloodDrop
{
+MISSILE
-NOGRAVITY
+CLIENTSIDEONLY
Scale 2.5
States
{
Spawn:
RKDR A 1 A_CheckFloor("Death")
loop
Death:
RKDR B 0 A_PlaySoundEX("classes/waterdrop", "Voice")
RKDR BCD 2
RKDR E 10
stop
}
}
/*
actor BloodVision : PowerSpeed
{
Powerup.Duration 150
Speed 1.0
Powerup.Color Red, 0.5
}
*/

actor CollideFlag : Inventory
{
inventory.amount 1
inventory.maxamount 1
}

actor WilyBurnTimer : Inventory
{
inventory.amount 1
inventory.maxamount 60
}

actor BleedingSpawner
{
Height 0
Radius 0
+NOINTERACTION
+NOCLIP
+SEEKERMISSILE
PROJECTILE
States
{
Spawn:
TNT1 A 0
TNT1 A 0 A_SetArg(0, ACS_ExecuteWithResult(257))
//TNT1 A 0 A_TransferPointer(AAPTR_DEFAULT, AAPTR_DEFAULT, AAPTR_TARGET, AAPTR_TRACER)
TNT1 A 0 A_TransferPointer(AAPTR_TARGET, AAPTR_DEFAULT, AAPTR_TARGET, AAPTR_TARGET)
TNT1 A 0 ACS_ExecuteAlways(CSACS_ROZPOISON,0,Args[0])
Goto DoT
DoT:
TNT1 A 2 A_SpawnItemEX("BloodDrop", random(-16,16), random(-16,16), random(16,48))
TNT1 A 0 A_JumpIfInventory("CollideFlag", 1, "Death")
TNT1 A 2 A_SpawnItemEX("BloodDrop", random(-16,16), random(-16,16), random(16,48))
TNT1 A 0 A_JumpIfInventory("CollideFlag", 1, "Death")
TNT1 A 2 A_SpawnItemEX("BloodDrop", random(-16,16), random(-16,16), random(16,48))
TNT1 A 0 A_JumpIfInventory("CollideFlag", 1, "Death")
TNT1 A 2 A_SpawnItemEX("BloodDrop", random(-16,16), random(-16,16), random(16,48))
TNT1 A 0 A_JumpIfInventory("CollideFlag", 1, "Death")
TNT1 A 2 A_SpawnItemEX("BloodDrop", random(-16,16), random(-16,16), random(16,48))
TNT1 A 0 A_JumpIfInventory("CollideFlag", 1, "Death")
TNT1 A 0 A_SpawnItemEx("BleedingDamager")
loop
Death:
TNT1 A 0
stop
}
}

actor BleedingDamager
{
damagetype "Bleeding"
Obituary "%o was left a bloody mess by %k's Bloody Bat.'"
PROJECTILE
+NOINTERACTION
+NOCLIP
+DONTSPLASH
speed 0
height 0
radius 0
damage (0)
states
{
spawn:
TNT1 A 0
TNT1 A 0 A_Explode(3,10,0, 0, 10)
stop
}
}