actor KingSpearInstagib : BaseMM8BDMWep
{
Weapon.AmmoUse 0
Weapon.AmmoGive 28
Weapon.SlotNumber 1
Obituary "%o was skewered by %k's Yamato Spear."
weapon.ammotype "KingYamatoClassAmmo"
inventory.pickupsound "weapon/weaponup"
+WEAPON.AMMO_OPTIONAL
+WEAPON.NOAUTOAIM
+WEAPON.CHEATNOTWEAPON
+INVENTORY.UNDROPPABLE
Scale 2.0
States
{
Spawn:
TNT1 A 0
stop
Ready:
YAMB A 0 ACS_ExecuteAlways(991,0,WCCS_KINGYAMATO)
YAMB A 6 A_WeaponReady(2)
YAMB A 0 A_GiveInventory("KingYamatoClassAmmo",1)
Goto Ready+1
Deselect:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Lower
YAMB A 1 A_Lower
Loop
Select:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
YAMB A 1 A_Raise
Loop
Fire:
YAMB BCD 3
YAMB A 0 A_PlaySoundEx("weapon/mbuster","Weapon")
YAMB A 0 A_FireCustomMissile("TrueYamatoSpear",0,8,0,0)
YAMB CDB 3
YAMB A 0 A_GiveInventory("KingYamatoClassAmmo",3)
Goto Ready+1
AltFire:
YAMB E 0 A_JumpIfInventory("KingYamatoClassAmmo", 28, "Tower")
NoAmmo:
YAMB CD 2 ACS_Execute(979,0)
Goto Ready+1
Tower:
YAMB EF 3
YAMB G 0 A_SpawnItemEx("CampTower")
YAMB GH 2 A_TakeInventory("KingYamatoClassAmmo",28)
goto Ready+1
}
}

actor TrueYamatoSpear : FastProjectile
{
PROJECTILE
Radius 16
Height 5
scale 2.5
+RIPPER
+DONTBLAST
damage (500)
Translation "192:192=213:213", "198:198=254:254"
damagetype "Instagib"
speed 100
States
{
Spawn:
TYMS A 1
loop
}
}

actor CampTower
{
PROJECTILE
+NOTARGETSWITCH
+DONTBLAST
-SOLID
+NOEXPLODEFLOOR
+RIPPER
Damage 0
Scale 2.5
ReactionTime 100
States
{
Spawn:
KYCT A 5
KYCT B 1 A_CountDown
KYCT B 0 A_JumpIfInTargetInventory("KingYamatoClassAmmo",14,"Death")
KYCT B 0 A_JumpIfCloser(256,"Protection")
KYCT B 1 A_TakeFromTarget("Camping",1)
goto Spawn+1
Protection:
KYCT A 0 A_GivetoTarget("Camping",1)
goto Spawn+1
Death:
KYCT B 0 A_TakeFromTarget("Camping",1)
Vanish:
KYCT B 1 A_FadeOut(0.05)
loop
}
}

actor Camping : PowerProtection
{
	damagefactor "Instagib", 0.0
	powerup.duration 999999999
}



actor YamatoFinger : BaseMM8BDMWep 
{
Weapon.AmmoUse 0
Weapon.SlotNumber 1
Obituary "%k forced his way through %o with the \cgErupting Yamato Finger!"
weapon.ammotype "KingYamatoClassAmmo"
inventory.pickupsound ""
Inventory.Pickupmessage ""
+WEAPON.AMMO_OPTIONAL
+WEAPON.CHEATNOTWEAPON
+INVENTORY.UNDROPPABLE
Scale 2.0
States
{
Spawn:
YAMB Z 0
stop
Ready:
YAMS A 0 A_Stop
YAMS A 0 SetPlayerProperty(0,1,0)
YAMS A 0 A_SpawnItemEx("KYRushProp",0,32)
KYFH ABCDEFGHI 2 A_PlaySoundEx("robot/bigeye","Weapon")
KYFH I 6
KYFH JKLMNOPQ 2 A_PlaySoundEx("robot/bigeye","Weapon")
KYFH Q 6
KYFH RS 2 A_PlaySoundEx("robot/bigeye","Weapon")
KYFH S 6
KYFH TU 2 A_PlaySoundEx("robot/bigeye","Weapon")
KYFH U 2
KYFH VW 2 A_PlaySoundEx("robot/bigeye","Weapon")
KYFH W 2
KYFH XYZ 2 A_PlaySoundEx("robot/bigeye","Weapon")
YFH2 B 0 A_PlaySoundEx("robot/bigeye","Weapon")
YFH2 A 2 ACS_ExecuteAlways(991,0,47)
YFH2 B 0 A_PlaySoundEx("robot/bigeye","Weapon")
YFH2 B 2 ACS_ExecuteAlways(991,0,43)
YFH2 B 6
YFH2 CDEFGHIJKLMNO 2 A_PlaySoundEx("robot/bigeye","Weapon")
YFH2 OOOOOOOOOO 2 A_SpawnItemEx("KYFingerSmoke")
YAMS A 0 SetPlayerProperty(0,1,4)
YAMS A 0 A_GiveInventory("YamatoFingerFlag",1)
YAMS A 0 A_ChangeFlag("NOGRAVITY",1)
YAMS A 0 A_ChangeFlag("SHOOTABLE",0)
YAMS AB 2
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS C 0 A_Recoil(-20)
YAMS C 1 A_SpawnItemEx("YamatoFingerDamager",16)
YAMS A 0 A_TakeInventory("YamatoFingerFlag",1)
YAMT B 0 SetPlayerProperty(0,0,0)
YAMS A 0 SetPlayerProperty(0,0,4)
YAMS A 0 A_ChangeFlag("NOGRAVITY",0)
YAMS A 0 A_ChangeFlag("SHOOTABLE",1)
YAMS BA 2
TNT1 A 0 A_GiveInventory("KingSpearInstagib") 
TNT1 A 0 A_SelectWeapon("KingSpearInstagib")
TNT1 A 0 A_TakeInventory("YamatoFinger")
YAMS A 0 A_GiveInventory("YamatoFingerTrigger",1)
goto Deselect
Fire:
TNT1 A 1
goto Fire
Deselect:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Lower
TNT1 A 1 A_Lower
Loop
Select:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
YAMB A 1 A_Raise
Loop
}
}

actor YamatoFingerFlag : Inventory
{
inventory.amount 1
inventory.maxamount 1
}

actor KYRushProp
{
+CLIENTSIDEONLY
+NONETID
scale 2.5
states
{
Spawn:
RUSH DEFABABABABABABABABABABABABABABABABABIIIIIIIIIIIIIIIIIIIIIIII 2
stop
}
}

actor KYFingerSmoke
{
+CLIENTSIDEONLY
+NOINTERACTION
+NONETID
scale 2.5
states
{
Spawn:
YRJS ABC 2
stop
}
}

actor YamatoFingerDamager
{
PROJECTILE
+DONTSPLASH
Damagetype "Yamato"
Damage 0
States
{
Spawn:
TNT1 A 0
TNT1 A 1 A_Explode(1000,128,0)
TNT1 A 0 A_PlaySoundEx("misc/gutsgboost", "Weapon")
stop
}
}

actor YamatoFingerTrigger : CustomInventory
{
inventory.amount 1
inventory.maxamount 1
inventory.pickupmessage "ERUPTING YAMATO FINGER!"
inventory.icon "KYSTI"
Inventory.PickupSound "item/1up"
+INVBAR
+COUNTITEM
scale 2.0
states
{
Use:
TNT1 A 0 A_TakeInventory("KingSpearInstagib")
TNT1 A 0 A_GiveInventory("YamatoFinger")
TNT1 A 0 A_SelectWeapon("YamatoFinger")
stop
}
}