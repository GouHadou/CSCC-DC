actor StoneFunkWep : Weapon
{
Weapon.SlotNumber 1
scale 2.0
Obituary "%o was buried alive by %k's Funky Stones."
Inventory.Pickupmessage "You got- The fuck you got?!"
weapon.ammotype "StoneDiveLimit"
+WEAPON.AMMO_OPTIONAL
+WEAPON.DONTBOB
+WEAPON.CHEATNOTWEAPON
+INVENTORY.UNDROPPABLE
DropItem "SuperArmWepGiver"
inventory.icon "TNT1A0"
States
{
Ready:
SFHV A 0 ACS_ExecuteAlways(998,0,WCCS_STONEFUNK)
SFHV A 1 A_WeaponReady
SFHV A 0 A_GiveInventory("StoneDiveLimit",1)
Goto Ready+1
SFHV C 0 A_SpawnItemEx("StoneFunkBSpawner",0,0,20,momx, momy, momz,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
SFHV C 1 A_WeaponReady
SFHV C 0 A_SpawnItemEx("StoneFunkBSpawner",0,0,20,momx, momy, momz,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
SFHV C 1 A_WeaponReady
SFHV C 0 A_GiveInventory("StoneDiveLimit",1)
Goto Ready+3

StoneReady:
SFHV C 0 A_SpawnItemEx("StoneFunkBSpawner",0,0,20,momx, momy, momz,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
SFHV C 1 A_WeaponReady
SFHV C 0 A_SpawnItemEx("StoneFunkBSpawner",0,0,20,momx, momy, momz,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
SFHV C 1 A_WeaponReady
SFHV C 0 A_TakeInventory("StoneDiveLimit",2)
SFHV B 0 A_JumpIfInventory("StoneDiveLimit",1,"StoneReady")
Goto FireRocks
Deselect:
TNT1 A 0 A_SelectWeapon("StoneFunkWepX")
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Lower
SFHV A 1 A_Lower
Loop
Select:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
SFHV A 1 A_Raise
Loop
Fire:
SFHV B 0 A_JumpIfInventory("StoneFunkFlag1",1,"FireRocks")
SFHV B 0 A_PlaySoundEx("weapon/superarmuse","Weapon")
SFHV B 0 A_GiveInventory("StoneFunkFlag1",1)
SFHV B 0 A_Stop
SFHV B 0 SetPlayerProperty(0,1,0)
SFHV B 1 A_SpawnItemEx("StoneFunkBSpawner",0,0,0,momx, momy, momz,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
SFHV B 1 A_SpawnItemEx("StoneFunkBSpawner",0,0,5,momx, momy, momz,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
SFHV C 1 A_SpawnItemEx("StoneFunkBSpawner",0,0,10,momx, momy, momz,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
SFHV C 1 A_SpawnItemEx("StoneFunkBSpawner",0,0,15,momx, momy, momz,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
SFHV B 0 SetPlayerProperty(0,0,0)
SFHV CCCCCC 1 A_SpawnItemEx("StoneFunkBSpawner",0,0,20,momx, momy, momz,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
goto StoneReady
FireRocks:
SFHV CC 2
SFHV C 0 A_PlaySoundEx("weapon/superarmhit", "Weapon")
SFHV C 0 A_FireCustomMissile("StoneRockToss0",0,0)
SFHV C 0 A_TakeInventory("StoneFunkFlag1",1)
SFHV BBAAAAAAAAA 2
goto Ready+1
AltFire:
SFHV B 0 A_JumpIfInventory("StoneFunkFlag1",1,"AltFireRocks")
SFHV B 1 A_JumpIfInventory("StoneDiveLimit",100,1)
Goto Air
SFHV B 0 A_PlaySoundEx("weapon/zip","Weapon")
SFHV C 0 ThrustThingZ(0,40,0,0)
SFHV C 0 A_GiveInventory("StoneDiveFlag",1)
SFHV B 1
SFHV B 1 A_JumpIf(z-floorz==0, "DigStart")
Goto Altfire+5
DigStart:
SFHV C 0 A_TakeInventory("StoneDiveLimit",10)
SFHV CCCCCCCCCCCC 0 A_SpawnItemEx("StoneRockDebris",0,0,0,random(-10,10),random(-10,10),random(2,10),random(0,360))
Goto Dig
Dig:
TNT1 A 0 A_GiveInventory("InvisibleFlag",1)
SFHV C 0 A_ChangeFlag("SOLID",0)
SFHV C 0 A_ChangeFlag("SHOOTABLE",0)
SFHV C 0 A_SetGravity (999)
SFHV C 0 A_ChangeFlag("PICKUP",0)
SFHV C 0 A_SetTranslucent(0.0,0)
SFHV C 0 A_Stop
TNT1 A 0 ThrustThingZ(0, 40, 1, 0)
TNT1 A 0 A_Stop 
goto AltHold
AltHold:
SFHV C 0 A_TakeInventory("StoneFunkFlag1",1)
SFHV C 0 A_TakeInventory("StoneDiveFlag",1)
TNT1 A 0 A_TakeInventory("StoneDiveLimit",1)
TNT1 A 0 A_SpawnItemEx("StoneRockDebris",0,0,0,random(-20,20),random(-20,20),random(2,10),random(0,360))
TNT1 A 2 A_PlayWeaponSound("weapon/drillout")
TNT1 A 2 A_JumpIfInventory("StoneDiveLimit",1,"KeepDiggin")
TNT1 A 0 ThrustThingZ(0, 255, 1, 0)
goto DigRelease
KeepDiggin:
TNT1 A 1 A_ReFire
goto DigRelease
DigRelease:
SFHV C 0 A_SpawnItemEx("StoneRockDebris",0,0,0,random(-10,10),random(-10,10),random(2,10),random(0,360))
SFHV C 0 A_TakeInventory("StoneDiveFlag",1)
SFHV C 0 A_ClearRefire
TNT1 A 0 A_Stop
TNT1 A 0 SetPlayerProperty(0,1,0)
SFHV C 0 A_SetTranslucent(1.0,0)
TNT1 A 0 A_PlayWeaponSound("weapon/drillout")
SFHV C 0 A_SetGravity (0.8)
TNT1 A 0 A_TakeInventory("InvisibleFlag",1)
SFHV B 10 ThrustThingZ(0, 60, 0, 0)
SFHV C 0 A_ChangeFlag("SOLID",1)
TNT1 A 0 SetPlayerProperty(0,0,0)
SFHV C 0 A_ChangeFlag("SHOOTABLE",1)
SFHV C 0 A_ChangeFlag("PICKUP",1)
SFHV B 2
SFHV B 15
goto Ready+1
Air:
SFHV A 0 ACS_Execute(979,0)
goto Ready+1
AltFireRocks:
SFHV CC 2
SFHV C 0 A_PlaySoundEx("weapon/superarmhit", "Weapon")
SFHV C 0 A_FireCustomMissile("AltStoneRockToss0",0,0)
SFHV C 0 A_TakeInventory("StoneFunkFlag1",1)
SFHV BBAA 2
goto Ready+1
}
}

actor StoneFunkFlag1 : Inventory
{
inventory.amount 1
inventory.maxamount 1
}


actor StoneDiveFlag : Inventory
{
inventory.amount 1
inventory.maxamount 1
}

actor StoneDiveLimit : Ammo
{
+INVENTORY.IGNORESKILL
inventory.amount 1
inventory.maxamount 200
}


actor StoneFunkBSpawner
{
PROJECTILE
+FORCEXYBILLBOARD
+SKYEXPLODE
+DONTBLAST
+NOINTERACTION
+NOTIMEFREEZE
Radius 0
Height 0
damage (0)
speed 0
States
{
Spawn:
TNT1 A 1
TNT1 A 0 A_SpawnItemEx("StoneFunkBarrier",48,0,0,momx, momy, momz,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
TNT1 A 0 A_SpawnItemEx("StoneFunkBarrierFX",48,0,0,momx, momy, momz,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
TNT1 A 0 A_SpawnItemEx("StoneFunkBarrier",0,48,0,momx, momy, momz,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
TNT1 A 0 A_SpawnItemEx("StoneFunkBarrierFX",0,48,0,momx, momy, momz,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
TNT1 A 0 A_SpawnItemEx("StoneFunkBarrier",-48,0,0,momx, momy, momz,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
TNT1 A 0 A_SpawnItemEx("StoneFunkBarrierFX",-48,0,0,momx, momy, momz,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
TNT1 A 0 A_SpawnItemEx("StoneFunkBarrier",0,-48,0,momx, momy, momz,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
TNT1 A 0 A_SpawnItemEx("StoneFunkBarrierFX",0,-48,0,momx, momy, momz,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
stop
}
}

actor StoneFunkBarrier
{
+MISSILE
+SHOOTABLE
+NOBLOOD
-SOLID
+DONTRIP
+GHOST
+NORADIUSDMG
+DONTSPLASH
+SHOOTABLE
+NOBLOOD
-SOLID
+NOTIMEFREEZE
+FORCEXYBILLBOARD
painchance 256
bloodtype ""
Speed 0
Damage 0
Height 15
Radius 15
health  0x7FFFFFFF
scale 2.5
States
{
Spawn:
SFPS A 2
stop
Death:
TNT1 A 1
stop
Pain:
SFPS A 2
stop
}
}

actor StoneRockToss0 : StoneFunkBSpawner
{
speed 1
States
{
Spawn:
TNT1 A 1
TNT1 A 0 A_SpawnItemEx("StoneRockToss1",48,0,0,momx*40, momy*40, momz*40,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
TNT1 A 0 A_SpawnItemEx("StoneRockToss1",0,48,0,momx*40, momy*40, momz*40,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
TNT1 A 0 A_SpawnItemEx("StoneRockToss1",-48,0,0,momx*40, momy*40, momz*40,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
TNT1 A 0 A_SpawnItemEx("StoneRockToss1",0,-48,0,momx*40, momy*40, momz*40,0,SXF_ABSOLUTEMOMENTUM|SXF_NOCHECKPOSITION,0)
stop
}
}

actor StoneRockToss1
{
Obituary "%o was buried alive by %k's Funky Stones."
PROJECTILE
+MTHRUSPECIES
+LOOKALLAROUND
+SKYEXPLODE
+FORCEXYBILLBOARD
Radius 15
Height 15
scale 2.5
damage (10)
damagetype "StonefunkRock"
speed 40
States
{
Spawn:
SFPS A 1
loop
Death:
TNT1 A 1
stop
}
}


actor AltStoneRockToss0 : StoneFunkBSpawner
{
speed 0
States
{
Spawn:
TNT1 A 1
TNT1 A 0 A_SpawnItemEx("StoneRockToss1",48,0,0,40,0,0,0,SXF_NOCHECKPOSITION,0)
TNT1 A 0 A_SpawnItemEx("StoneRockToss1",48,0,0,40,0,0,90,SXF_NOCHECKPOSITION,0)
TNT1 A 0 A_SpawnItemEx("StoneRockToss1",48,0,0,40,0,0,-90,SXF_NOCHECKPOSITION,0)
TNT1 A 0 A_SpawnItemEx("StoneRockToss1",48,0,0,40,0,0,180,SXF_NOCHECKPOSITION,0)
stop
}
}

actor StoneFunkBarrierFX : StoneRockToss1
{
+NOTIMEFREEZE
+NOINTERACTION
+DONTBLAST
+NONETID
+CLIENTSIDEONLY
Radius 0
Height 0
scale 2.5
damage (0)
speed 0
States
{
Spawn:
SFPS A 2
stop
Death:
TNT1 A 1
stop
}
}

actor StoneRockDebris : StoneRockToss1
{
-NOGRAVITY
//Radius 15
//Height 15
scale 2.5
damage (7)
States
{
Spawn:
SFPS A 1
loop
Death:
TNT1 A 1
stop
}
}

actor StoneFunkWepX : StoneFunkWep
{
Weapon.AmmoGive 0
States
{
Deselect:
TNT1 A 0 A_SelectWeapon("StoneFunkWep")
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Lower
TNT1 A 1 A_Lower
Loop
Select:
TNT1 A 0 A_SelectWeapon("StoneFunkWep")
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
YAMB A 1 A_Raise
Loop
}
}
