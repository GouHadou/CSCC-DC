actor ZenSphereWep : BaseMM8BDMWep
{
Weapon.AmmoUse 2
Weapon.AmmoGive 28
Weapon.SlotNumber 2
Inventory.Pickupmessage "$PU_ZENSPHERE"
Obituary "$OB_ZENTRAINERWEP"
Tag "$TAG_ZENSPHERE"
weapon.ammotype "ZenSphereAmmo"
inventory.icon "ZENSPI"
States
{
Spawn:
ZSPH A 1
loop
Ready:
ZSPH B 0 ACS_ExecuteAlways(998,0,DYE_ZenTrainer)
ZSPH B 1 A_WeaponReady
Goto Ready+1
Deselect:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Lower
ZSPH B 1 A_Lower
Loop
Select:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
ZSPH B 1 A_Raise
Loop

Fire:
ZSPH B 0 A_JumpIfNoAmmo("NoAmmo")
ZSPH B 1
ZSPH B 0 A_FireCustomMissile("ZenSphereBall",0,1,8,0)
ZSPH CD 2 A_GiveInventory("PsychicBallHold")
ZSPH D 0 A_Refire("Hold")
ZSPH DDCCBBBB 2 A_TakeInventory("PsychicBallHold",999)
Goto Ready+1
Hold:
ZSPH R 2 A_GiveInventory("PsychicBallHold")
ZSPH R 0 A_JumpIfNoAmmo("HoldEnd")
ZSPH R 0 A_Refire(1)
goto HoldEnd
ZSPH Q 2 A_GiveInventory("PsychicBallHold")
ZSPH R 0 A_JumpIfNoAmmo("HoldEnd")
ZSPH Q 0 A_Refire(1)
goto HoldEnd
ZSPH P 2 A_GiveInventory("PsychicBallHold")
ZSPH R 0 A_JumpIfNoAmmo("HoldEnd")
ZSPH P 0 A_Refire(1)
goto HoldEnd
ZSPH O 2 A_GiveInventory("PsychicBallHold")
ZSPH R 0 A_JumpIfNoAmmo("HoldEnd")
ZSPH O 0 A_Refire(1)
goto HoldEnd
ZSPH N 2 A_GiveInventory("PsychicBallHold")
ZSPH R 0 A_JumpIfNoAmmo("HoldEnd")
ZSPH N 0 A_Refire(1)
goto HoldEnd
ZSPH M 2 A_GiveInventory("PsychicBallHold")
ZSPH R 0 A_JumpIfNoAmmo("HoldEnd")
ZSPH M 0 A_Refire(1)
goto HoldEnd
ZSPH M 2 A_GiveInventory("PsychicBallHold")
ZSPH R 0 A_JumpIfNoAmmo("HoldEnd")
ZSPH M 0 A_Refire(1)
goto HoldEnd
ZSPH N 2 A_GiveInventory("PsychicBallHold")
ZSPH R 0 A_JumpIfNoAmmo("HoldEnd")
ZSPH N 0 A_Refire(1)
goto HoldEnd
ZSPH O 2 A_GiveInventory("PsychicBallHold")
ZSPH R 0 A_JumpIfNoAmmo("HoldEnd")
ZSPH O 0 A_Refire(1)
goto HoldEnd
ZSPH P 2 A_GiveInventory("PsychicBallHold")
ZSPH R 0 A_JumpIfNoAmmo("HoldEnd")
ZSPH P 0 A_Refire(1)
goto HoldEnd
ZSPH Q 2 A_GiveInventory("PsychicBallHold")
ZSPH R 0 A_JumpIfNoAmmo("HoldEnd")
ZSPH Q 0 A_Refire(1)
goto HoldEnd
ZSPH R 2 A_GiveInventory("PsychicBallHold")
ZSPH R 0 A_JumpIfNoAmmo("HoldEnd")
ZSPH R 0 A_Refire(1)
goto HoldEnd
ZSPH D 2 A_GiveInventory("PsychicBallHold")
ZSPH R 0 A_JumpIfNoAmmo("HoldEnd")
ZSPH D 0 A_Refire("Hold")
goto HoldEnd

HoldEnd:
ZSPH H 0 A_ClearRefire
ZSPH DDCCBBBB 2 A_TakeInventory("PsychicBallHold",999)
goto Ready+1

Altfire:
ZSPH B 0 A_JumpIfNoAmmo("NoAmmo")
ZSPH B 1
ZSPH B 0 A_FireCustomMissile("ZenSphereBall",0,1,8,0)
ZSPH CD 2 A_GiveInventory("PsychicBallHold")
ZSPH DDCCBBBB 2 A_TakeInventory("PsychicBallHold",999)
Goto Ready+1

NoAmmo:
ZSPH H 0 A_ClearRefire
ZSPH B 1 ACS_Execute(979,0)
Goto Ready+1
}
}

actor ZenSphereAmmo : Ammo
{
+INVENTORY.IGNORESKILL
inventory.amount 1
inventory.maxamount 28
}

actor ZenSphereBall : ZTPsychicBall
{

States
{
Spawn:
TNT1 A 0
TNT1 A 0 A_PlaySoundEx("weapon/blackholebomb","Weapon",1)
BLKH BCDEBCDEBC 1 A_SpawnItemEx("ZTPsychicBallGFX2",0,random(-6,6),random(-6,6),0,0,0,0,1)
SpawnC:
BLKH BCDEBCDEBCDEBCDEBCDE 1 A_Stop
BLKH B 1 A_JumpIfInTargetInventory("PsychicBallHold",1,"SpawnC2")
goto StopNow
SpawnC2:
BLKH BCDE 2 A_PlaySoundEx("weapon/blackholebomb","Weapon",1)
BLKH B 0 A_SpawnItemEx("ZTPsychicBallGFX",0,0,0,0,0,0,0,1)
BLKH B 1 A_JumpIfInTargetInventory("PsychicBallHold",1,"SpawnC2")
goto StopNow
Crash:XDeath:Death:
TNT1 A 0 A_Warp(AAPTR_Tracer,0,0,90,0,WARPF_NoCheckPosition|WARPF_COPYINTERPOLATION,"ExplodeLooping")
goto StopNow
Explodenow:
TNT1 A 0 A_TakeInventory("CutterFlag",999)
TNT1 A 0 A_TakeFromTarget("ZenSphereAmmo",2)
TNT1 A 0 A_PlaySoundEx("weapon/blackholebombdetonate", "body", 1)
TNT1 A 0 A_SpawnItemEX("FakeZTPsychicBallGFX",0,0,0,0,0,0,0,1)
TNT1 A 1 A_Warp(AAPTR_Tracer,0,0,0,0,WARPF_NoCheckPosition|WARPF_COPYINTERPOLATION)
TNT1 AAAAAAAA 0 A_SpawnItemEx("ZTPsychicBallGFX2",32,0,random(0,40),random(6,12),0,random(-6,6),random(0,360),1)
TNT1 A 0 A_Explode(10,64,0,0,42)
goto ExplodeLooping
ExplodeLooping:
BLKH B 0 A_JumpIfCloser(1024,2)
BLKH B 2
goto StopNow
BLKH B 0 A_JumpIfInTargetInventory("PsychicBallHold",1,2)
BLKH B 2
goto StopNow
TNT1 A 0 A_JumpIfInTargetInventory("IsDead",1,"StopNow")
TNT1 A 0 A_JumpIfInventory("IsDead",1,"StopNow",AAPTR_Tracer)
TNT1 A 0 A_JumpIfInventory("CutterFlag",7,"Explodenow")
TNT1 A 0 A_GiveInventory("CutterFlag",1)
TNT1 A 0 A_SpawnItemEx("ZTPsychicBallGFX2",32,0,random(-90,-50),0,0,0,random(0,360),1)
BLKH BCDEBCDE 1 A_Warp(AAPTR_Tracer,0,0,90,0,WARPF_NoCheckPosition|WARPF_COPYINTERPOLATION)
TNT1 A 0 A_StopSoundEx("Body")
goto ExplodeLooping
StopNow:
BLKH B 0 A_SetScale(scalex, scaley - 0.15)
BLKH B 1 A_FadeOut(0.1) 
BLKH C 0 A_SetScale(scalex, scaley - 0.15)
BLKH C 1 A_FadeOut(0.1) 
BLKH D 0 A_SetScale(scalex, scaley - 0.15)
BLKH D 1 A_FadeOut(0.1) 
BLKH E 0 A_SetScale(scalex, scaley - 0.15)
BLKH E 1 A_FadeOut(0.1)
loop
}
}

actor ZenSphereWepCS : ZenSphereWep replaces ZenSphereWep
{
States
{
CSCC_DefaultSpawn:
TNT1 A 0 A_SetTranslucent(1.0, 0)
goto Spawn+3
CSCC_TranslucentSpawn:
TNT1 A 0 A_SetTranslucent(0.5, 0)
goto Spawn+3
Spawn:
TNT1 A 0
TNT1 A 0 ACS_NamedExecuteAlways("CSACS_FakeWeaponPickup",0,0)
TNT1 A 0 ACS_NamedExecuteAlways("CSACS_WeaponDisplay",0,0)
ZSPH A 5
goto Spawn+2
}
}

