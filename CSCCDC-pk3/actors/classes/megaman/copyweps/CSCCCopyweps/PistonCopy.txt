actor PistonTremorWep : BaseMM8BDMWep
{
Weapon.AmmoUse 4
Weapon.AmmoGive 28
Weapon.SlotNumber 6
Inventory.Pickupmessage "Power Up! Piston Tremor!"
Obituary "%o couldn't stand their ground against %k's Piston Tremor."
Tag "Piston Tremor"
weapon.ammotype "PistonTremorCopyAmmo"
inventory.icon "PISTRE"
States
{
Spawn:
PTRE A 1
loop
Ready:
PTRE D 0 ACS_ExecuteAlways(998,0,DYE_PISTONMAN)
PTRE D 1 A_WeaponReady
Goto Ready+1
Deselect:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Lower
PTRE D 1 A_Lower
Loop
Select:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
PTRE D 1 A_Raise
Loop
Fire:
PTRE E 0 A_JumpIfNoAmmo("NoAmmo")
PTRE EFGG 2
FireLoop:
PTRE G 1 A_CheckFloor("Continue")
goto FireLoop
Continue:
PTRE HIJ 1
PTRE E 0 A_TakeInventory("PistonTremorCopyAmmo",4)
PTRE J 0 A_SpawnItemEX("PistonExplodeCopy")
PTRE J 0 ThrustThingZ(0,80,0,0)
TNT1 A 12
FireEnd:
PTRE BC 2
PTRE D 0 A_Refire
Goto Ready+1
NoAmmo:
PTRE D 1 ACS_Execute(979,0)
Goto Ready+1
}
}

actor PistonExplodeCopy : PistonExplode
{
translation "192:192=87:87", "198:198=95:95"
damagetype "PistonPunchStun2"
Obituary "%o couldn't stand their ground against %k's Piston Tremor."
States
{
Spawn:
TNT1 A 0
TNT1 A 0 A_Explode(35,200,0)
TNT1 A 0 A_PlaySoundEx("cscc/pistonhit", "Weapon")
TNT1 A 0 A_SpawnItemEx("PistonStunFX", 200, 0, 8, 0, 0, random(7,11), 0,SXF_TRANSFERTRANSLATION)
TNT1 A 0 A_SpawnItemEx("PistonStunFX", 200, 0, 8, 0, 0, random(7,11), 45,SXF_TRANSFERTRANSLATION)
TNT1 A 0 A_SpawnItemEx("PistonStunFX", 200, 0, 8, 0, 0, random(7,11), 90,SXF_TRANSFERTRANSLATION)
TNT1 A 0 A_SpawnItemEx("PistonStunFX", 200, 0, 8, 0, 0, random(7,11), -90,SXF_TRANSFERTRANSLATION)
TNT1 A 0 A_SpawnItemEx("PistonStunFX", 200, 0, 8, 0, 0, random(7,11), -45,SXF_TRANSFERTRANSLATION)
TNT1 A 0 A_SpawnItemEx("PistonStunFX", 200, 0, 8, 0, 0, random(7,11), 135,SXF_TRANSFERTRANSLATION)
TNT1 A 0 A_SpawnItemEx("PistonStunFX", 200, 0, 8, 0, 0, random(7,11), -135,SXF_TRANSFERTRANSLATION)
TNT1 A 0 A_SpawnItemEx("PistonStunFX", 200, 0, 8, 0, 0, random(7,11), 180,SXF_TRANSFERTRANSLATION)
TNT1 AAAAAAA 0 A_SpawnItemEX("PistonTremorFX2",random(0,150),0,0,random(1,3),0,random(10,25),random(0,359),SXF_TRANSFERTRANSLATION)
TNT1 AAAAAAAAA 0 A_SpawnItemEX("PistonTremorFX",random(0,150),0,0,random(1,3),0,random(12,27),random(0,359),SXF_TRANSFERTRANSLATION)
stop
}
}

actor PistonTremorCopyAmmo : Ammo
{
inventory.amount 1
inventory.maxamount 28
+INVENTORY.IGNORESKILL
}
/*
actor PistonTremorWepC : PistonTremorWep
{
dropitem "PistonTremorWepCDropped"
States
{
Spawn:
TNT1 A 0
stop
ReadyC:Goto Ready+1
}
}

actor PistonTremorWepCDropped : WepCDropped
{
inventory.pickupmessage "Power Up! Piston Tremor!"
States
{
Spawn:
PTRE A 1500
stop
Pickup1:
TNT1 A 0 A_JumpIfInventory("PistonTremorCopyAmmo",0,"No")
goto Pickup2
Pickup3:
TNT1 A 0 A_GiveInventory("PistonTremorWepC",1)
stop
}
}
*/

actor PistonTremorWepCS : PistonTremorWep replaces PistonTremorWep
{
States
{
CSCC_DefaultSpawn:
TNT1 A 0 A_SetTranslucent(1.0, 0)
goto Spawn
CSCC_TranslucentSpawn:
TNT1 A 0 A_SetTranslucent(0.5, 0)
goto Spawn
Spawn:
PLAY A 5
TNT1 A 0 ACS_NamedExecuteAlways("CSACS_WeaponDisplay",0,0)
PLAY A 5
loop
}
}