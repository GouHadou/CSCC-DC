actor MissilePunchWep : CSCCWepBase 
{
Weapon.AmmoUse 1
Weapon.SlotNumber 1
Obituary "%o was destroyed by %k's \chPower Missiles\c-."
Inventory.Pickupmessage "Power up! Missile Punch!"
weapon.ammotype "MissilePunchAmmo"
inventory.icon "LOSICA0"
Tag "Missile Punch"
dropitem "SteelPunchWepCS"
States
{
Spawn:
WEA2 S 1
loop
Ready:
MSPN A 1 ACS_ExecuteAlways(998,0,DYE_LORDDAMAGERCOL)
MSPN A 0 A_GunFlash
Ready2:
MSPN A 1 A_WeaponReady
MSPN A 0 A_JumpIfInventory("LDRamming",1,"PreRamming")
MSPN A 0 A_jumpifinventory("MissilePunchAmmo",1,"Ready2")
Goto Reload
Deselect:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Lower
MSPN A 1 A_Lower
Loop
Select:
TNT1 AAAAAAAAAAAAAAAAAAAAAA 0 A_Raise
MSPN A 1 A_Raise
Loop

Fire:
MSPN A 0 SetPlayerProperty(0,0,0)
MSPN A 0 A_TakeInventory("LDRamEarlyEnd",1)
MSPN A 0 A_JumpIfNoAmmo("NoAmmo") 
MSPN A 0 A_PlaySoundEx("weapon/MagnetMissile","Weapon")
MSPN DE 3 A_WeaponReady(WRF_NOSWITCH|WRF_NOPRIMARY|WRF_NOSECONDARY)
MSPN A 0 A_GiveInventory("PowerMissileColors")
MSPN EAAAAAAAAA 2 A_WeaponReady(WRF_NOSWITCH|WRF_NOPRIMARY|WRF_NOSECONDARY)
MSPN A 0 A_Refire
Goto Ready2

AltFire:
MSPN A 0 SetPlayerProperty(0,0,0)
MSPN A 0 A_TakeInventory("LDRamEarlyEnd",1)
MSPN A 2
MSPN A 0 A_PlaySoundEx("Weapon/napalm","Weapon")
MSPN A 0 A_FireCustomMissile("MissilePunch",0,0,-2,-8)
MSPN A 0 A_GiveInventory("MissilePunchFXColors")
MSPN BCCCCCBAAAAA 2 A_WeaponReady(WRF_NOSWITCH|WRF_NOPRIMARY|WRF_NOSECONDARY)
Goto Ready2

Reload:
"####" B 1 Offset(0,32)
"####" B 1 Offset(0,46)
"####" B 1 Offset(0,58)
"####" B 1 Offset(0,70)
"####" B 1 Offset(0,82)
"####" A 0 A_PlaySoundEx("weapon/rminestick","Weapon")
"####" B 45 A_WeaponReady(WRF_NOBOB|WRF_NOPRIMARY)
"####" B 0 A_Giveinventory("MissilePunchAmmo",5)
"####" B 0 A_PlaySoundEx("weapon/Crashland","Weapon")
"####" B 1 Offset(0,82)
"####" B 1 Offset(0,70)
"####" B 1 Offset(0,58)
"####" B 1 Offset(0,46)
"####" B 1 Offset(0,32)
"####" B 0 A_TakeInventory("LDRamming",99)
"####" B 1 A_Refire("Fire")
Goto Ready2

PreRamming:
MSPN A 0 A_GiveInventory("RamAmmoBuffer")
MSPN A 0 SetPlayerProperty(0,1,0)
MSPN C 15 A_PlaySoundEx("weapon/pcharge","Weapon")
MSPN A 0 A_TakeInventory("LDRamming",1)
MSPN A 0 A_TakeInventory("LDRamEarlyEnd",1)
Ramming:
MSPN A 0 A_JumpIfInventory("LDRamEarlyEnd",1,"BounceOff")
MSPN C 1 A_WeaponReady(WRF_NOSWITCH)
MSPN A 0 A_Recoil(-3)
MSPN A 0 A_FireCustomMissile("LDRamChecker",0,0,0,0)
MSPN A 0 A_GiveInventory("LDRamAttackColors")
MSPN A 0 A_GiveInventory("RamAmmoBuffer")
MSPN A 0 A_PlaySoundEx("misc/gutsgboost","Voice")
MSPN A 0 A_TakeInventory("LDRamEnergy",1)
MSPN A 0 A_JumpIfInventory("LDRamEnergy",2,"Ramming")
goto RamEnd
BounceOff:
MSPN A 0 A_PlaySoundEx("misc/quake","SoundSlot7")
MSPN A 0 A_Recoil(15)
MSPN A 0 ThrustThingZ(0, 32, 0, 0)
MSPN A 0 A_GiveInventory("LDRamEarlyEnd",1)
MSPN A 0 A_TakeInventory("JumpCancler",1)
RamEnd:
MSPN A 0 SetPlayerProperty(0,0,0)
MSPN A 0 A_TakeInventory("LDRamEarlyEnd",1)
MSPN AAAAAAAAAAAAAAAAA 1 A_WeaponReady(WRF_NOSWITCH)
goto Ready+1

NoAmmo:
MSPN A 1
Goto Reload
Flash:
TNT1 A 7
TNT1 A 0 A_GiveInventory("LaserCannonAmmo",3)
TNT1 A 0 A_JumpIfInventory("RamAmmoBuffer",1,2)
TNT1 A 0 A_GiveInventory("LDRamEnergy",1)
TNT1 A 0
loop
}
}

//Inventory and Flags
actor MissilePunchAmmo : Ammo
{
+INVENTORY.IGNORESKILL
inventory.amount 1
inventory.maxamount 5
}

actor SmogCannonAmmo : Ammo
{
+INVENTORY.IGNORESKILL
inventory.amount 1
inventory.maxamount 50
}

actor LDRamEnergy : Ammo
{
+INVENTORY.IGNORESKILL
inventory.amount 1
inventory.maxamount 56
}

Actor RamAmmoBuffer : Powerup {inventory.amount 1 inventory.maxamount 1 powerup.duration 20}
Actor BeamAmmoBuffer : Powerup {inventory.amount 1 inventory.maxamount 1 powerup.duration 8}

//Mainfire
actor PowerMissileColors : LDColorBase
{
States
{
Default:
TNT1 A 0 A_FireCustomMissile("PowerMissile",0,1,-8,0)
stop
LightFire:
TNT1 A 0 A_FireCustomMissile("PowerMissileB",0,1,-8,0)
stop
WilyFire:
TNT1 A 0 A_FireCustomMissile("PowerMissileR",0,1,-8,0)
stop
CossackFire:
TNT1 A 0 A_FireCustomMissile("PowerMissileG",0,1,-8,0)
stop
KingFire:
TNT1 A 0 A_FireCustomMissile("PowerMissileY",0,1,-8,0)
stop
}
}

actor PowerMissile : BasicFastProjectile
{
Obituary "%o was destroyed by %k's \chPower Missiles\c-."
PROJECTILE
+SKYEXPLODE
+DONTBLAST
//+MTHRUSPECIES
+BLOODSPLATTER
Radius 8
Height 8
damage (20)
damagetype "PMissile"
speed 65
scale 4.5
States
{
Spawn:
TNT1 A 0
LOMS AB 2 A_PlaySoundEx("weapon/superboost","Weapon")
loop
Death:
MMFX B 0 A_SpawnItemEx("PMissileExplosion")
MMFX B 1
stop
}
}

actor PowerMissileB : PowerMissile
{
translation "80:95=205:205", "236:246=74:74"
States
{
Death:
MMFX B 1 A_SpawnItemEx("PMissileExplosionB")
stop
}
}

actor PowerMissileR : PowerMissile
{
translation "80:95=171:171", "236:246=41:41"
States
{
Death:
MMFX B 1 A_SpawnItemEx("PMissileExplosionR")
stop
}
}

actor PowerMissileG : PowerMissile
{
translation "80:95=104:104", "236:246=128:128"
States
{
Death:
MMFX B 1 A_SpawnItemEx("PMissileExplosionG")
stop
}
}

actor PowerMissileY : PowerMissile
{
translation "80:95=229:229", "236:246=232:232"
States
{
Death:
MMFX B 1 A_SpawnItemEx("PMissileExplosionY")
stop
}
}



actor PMissileExplosion 
{
Obituary "%o was destroyed by %k's \chPower Missiles\c-."
PROJECTILE
+NOINTERACTION
+NOCLIP
+DONTBLAST
+FORCEXYBILLBOARD
+BLOODSPLATTER
//+MTHRUSPECIES
damagetype "PMissile"
Speed 0
radius 8
height 8
scale 2.5
States
{
Spawn:
TNT1 A 0
TNT1 A 0 A_PlaySoundEx("weapon/hyperbomb", "Weapon")
TNT1 A 0 A_Explode(10,160,0,0,80)
BOMB BDFHJLNOQ 1
stop
}
}

actor PMissileExplosionB : PMissileExplosion{translation "4:208=205:205", "209:212=74:74"}
actor PMissileExplosionR : PMissileExplosion{translation "4:208=171:171", "209:212=41:41"}
actor PMissileExplosionG : PMissileExplosion{translation "4:208=104:104", "209:212=128:128"}
actor PMissileExplosionY : PMissileExplosion{translation "4:208=229:229", "209:212=232:232"}

//Altfire
actor MissilePunch : BasicProjectile
{
PROJECTILE
Obituary "%o was crushed by %k's \chMissile Punch\c-."
//+MTHRUSPECIES
+DONTBLAST
+THRUGHOST
damage (35)
damagetype "DamagerFist"
height 32
radius 24
Speed 90
scale 2.5
states
{
Spawn:
TNT1 A 0
TNT1 A 1
stop
}
}

actor MissilePunchFXColors : LDColorBase
{
States
{
Default:
TNT1 A 0 A_FireCustomMissile("MissilePunchFX",0,0,-2,-8)
TNT1 A 0 A_FireCustomMissile("MissilePunchFX2",0,0,-2,-8)
stop
LightFire:
TNT1 A 0 A_FireCustomMissile("MissilePunchFXB",0,0,-2,-8)
TNT1 A 0 A_FireCustomMissile("MissilePunchFX2B",0,0,-2,-8)
stop
WilyFire:
TNT1 A 0 A_FireCustomMissile("MissilePunchFXR",0,0,-2,-8)
TNT1 A 0 A_FireCustomMissile("MissilePunchFX2R",0,0,-2,-8)
stop
CossackFire:
TNT1 A 0 A_FireCustomMissile("MissilePunchFXG",0,0,-2,-8)
TNT1 A 0 A_FireCustomMissile("MissilePunchFX2G",0,0,-2,-8)
stop
KingFire:
TNT1 A 0 A_FireCustomMissile("MissilePunchFXY",0,0,-2,-8)
TNT1 A 0 A_FireCustomMissile("MissilePunchFX2Y",0,0,-2,-8)
stop
}
}


actor MissilePunchFX 
{
translation "192:192=194:194","198:198=241:241"
PROJECTILE
+NOINTERACTION
+NOCLIP
+CLIENTSIDEONLY
radius 8
height 8
damage (0)
scale 3.5
Speed 90
Reactiontime 35
Renderstyle "Translucent"
Alpha 1.0
states
{
Spawn:
TNT1 A 0
TNT1 A 1 
TNT1 A 0 A_Stop
GIGF CD 1 
GIGF CDCDC 1 A_FadeOut(0.25)
stop
}
}

actor MissilePunchFXB : MissilePunchFX{translation "192:192=205:205", "198:198=74:74", "193:195=74:74"}
actor MissilePunchFXR : MissilePunchFX{translation "192:192=171:171", "198:198=41:41", "193:195=41:41"}
actor MissilePunchFXG : MissilePunchFX{translation "192:192=104:104", "198:198=128:128", "193:195=128:128"}
actor MissilePunchFXY : MissilePunchFX{translation "192:192=229:229", "198:198=232:232", "193:195=232:232"}

actor MissilePunchFX2 : MissilePunchFX
{
translation "192:192=194:194","198:198=241:241"
scale 2.5
States
{
Spawn:
TNT1 A 0
TNT1 A 1
GIGF D 0 A_Stop

BEWA B 1 A_Fadeout
BEWA B 0 A_SetScale(2.6,2.6)

BEWA B 1 A_Fadeout
BEWA B 0 A_SetScale(2.8,2.8)

BEWA B 1 A_Fadeout
BEWA B 0 A_SetScale(3.0,3.0)

BEWA B 1 A_Fadeout
BEWA B 0 A_SetScale(3.2,3.2)

BEWA B 1 A_Fadeout
BEWA B 0 A_SetScale(3.4,3.4)

BEWA B 1 A_Fadeout
BEWA B 0 A_SetScale(3.6,3.6)
stop
}
}

actor MissilePunchFX2B : MissilePunchFX2{translation "192:192=205:205", "198:198=74:74", "193:195=74:74"}
actor MissilePunchFX2R : MissilePunchFX2{translation "192:192=171:171", "198:198=41:41", "193:195=41:41"}
actor MissilePunchFX2G : MissilePunchFX2{translation "192:192=104:104", "198:198=128:128", "193:195=128:128"}
actor MissilePunchFX2Y : MissilePunchFX2{translation "192:192=229:229", "198:198=232:232", "193:195=232:232"}

//Item
actor LDRamActivator : CustomInventory
{
inventory.amount 1
inventory.maxamount 1
inventory.icon "LDRMI0"
//+INVENTORY.UNDROPPABLE copy robot wills it this way
+COUNTITEM
+INVBAR
states
{
Spawn:
TNT1 A 0
loop
Use:
TNT1 A 0 A_JumpIfInventory("LDRamEnergy",26,"StartRamming")
TNT1 A 0 A_PlaySoundEx("weapon/noammo","SoundSlot6")
fail
StartRamming:
TNT1 A 0 A_GiveInventory("LDRamming",1)
fail
}
}

Actor LDRamming : Inventory{}
Actor LDRamEarlyEnd : Inventory{}

actor LDRamAttackColors : LDColorBase
{
States
{
Default:
TNT1 A 0 A_FireCustomMissile("LDRamAttack",0,0,0,0)
stop
LightFire:
TNT1 A 0 A_FireCustomMissile("LDRamAttackB",0,0,0,0)
stop
WilyFire:
TNT1 A 0 A_FireCustomMissile("LDRamAttackR",0,0,0,0)
stop
CossackFire:
TNT1 A 0 A_FireCustomMissile("LDRamAttackG",0,0,0,0)
stop
KingFire:
TNT1 A 0 A_FireCustomMissile("LDRamAttackY",0,0,0,0)
stop
}
}

actor LDRamAttack
{
PROJECTILE
translation "4:4=194:194", "225:225=241:241"
+MTHRUSPECIES
Obituary "%o was knocked down by %k's \chRam\c-."
radius 1
height 1
speed 80
damage(0)
damagetype "LDRam"
scale 1.0
States
{
Spawn:
TNT1 A 0
TNT1 A 1
Death:
TNT1 A 0 A_Stop
CKIC DEF 1 A_Explode(2, 50, 0)
stop
}
}

actor LDRamAttackB : LDRamAttack{translation "4:4=205:205", "225:225=74:74"}
actor LDRamAttackR : LDRamAttack{translation "4:4=171:171", "225:225=41:41"}
actor LDRamAttackG : LDRamAttack{translation "4:4=104:104", "225:225=128:128"}
actor LDRamAttackY : LDRamAttack{translation "4:4=229:229", "225:225=232:232"}

actor LDRamChecker
{
PROJECTILE
+MTHRUSPECIES
+THRUACTORS
+DONTREFLECT
+DONTSPLASH
Radius 12
Height 12
Speed 40
states
{
Spawn:
TNT1 A 0
TNT1 A 4
stop
Death:
TNT1 A 0 A_Stop
TNT1 A 0 A_JumpIf(CeilingZ - FloorZ <=48 , "XDeath")
TNT1 A 0 A_CheckFloor("XDeath")
TNT1 A 0 A_CheckCeiling("XDeath")
TNT1 A 0 A_GiveToTarget("LDRamEarlyEnd",1)
stop
XDeath:
Crash:
Floor:
TNT1 A 0
stop
}
}